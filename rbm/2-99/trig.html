<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><HTML><HEAD>	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">	<TITLE>Trig</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><P><FONT SIZE="5"><B>Using Trigonometry in REALbasic</B><BR>By Dan Vanderkam</FONT></P><P>&#160;&#160;You probably know that the Sin, Cos and Tan functions in RB take ina number and give you another number. You may also know that they're related to trigonometry(or, as most people call it, trig). However, I've been surprised at how many peopledon't have a <B>clue</B> about how they're used. So, I've written this article tohelp show people how to use them, and why they're really, really useful.</P><P><HR SIZE="1" NOSHADE></P><P>&#160;&#160;OK, to start off, get out a piece of paper, and draw a nice largecircle on it, like so:</P><CENTER><P><IMG SRC="trigcircle1.gif" WIDTH="122" HEIGHT="120" ALIGN="BOTTOM" BORDER="0"></P></CENTER><P>&#160;&#160;Now that you have the circle, draw two lines through it, and labeltheir intersection (0,0). Now, label the edges like this: The left edge of the circleis (-1,0), the right edge is (1,0), the top edge is (0,1), and the bottom edge is(0,-1). Your picture should look something like this:</P><CENTER><P><IMG SRC="trigcircle2.gif" WIDTH="181" HEIGHT="152" ALIGN="BOTTOM" BORDER="0"></P></CENTER><P>&#160;&#160;As you may have noticed, we now have a cicle on a coordinate plane.Its radius is 1. This makes it quite easy to find the four points we have labeled(which are all at 90&#176; intervals), but what if we want to get the coordinatesof an inbetween angle, like 47.3? That would be rather difficult to make a computerdo.Thankfully, this is exactly what Sin and Cos do. Our next step shows what thepoint at 47.3 degrees is:</P><CENTER><P><IMG SRC="image29.gif" WIDTH="181" HEIGHT="151" ALIGN="BOTTOM" BORDER="0"></P></CENTER><P>&#160;&#160;So, the Sine of a degree is its X coordinate, and the Cosine of adegree is its Y coordinate. Pretty simple, huh? Of course, there are drawbacks. Firstof all, this only works for circles with a radius of 1, and on a computer screen,one pixel is not much. This is easy enough to fix though; just multiply the coordinatesby the circle's radius.</P><P>&#160;&#160;Also, there's another drawback. The Sin and Cos functions (As wellas all the other Trig functions in RB) don't use degrees. They use another systemcalled Radians. Radians are usually a number times Pi. For example 360&#176; and2p radians are the exact same. 90&#176; and 1/2 p radians are the same thing too.</P><P>&#160;&#160;Unfortunately, p isn't a very good number for a computer. It goeson endlessly, which would mean that your computer would need an infinite amount ofRAM too. Not good. However, there is a simple way to convert. Try this code:</P><P><TT>&#160;&#160;Dim Deg2Rad as Double<BR>&#160;&#160;Deg2Rad=ATan(1)/45<BR>&#160;&#160;MsgBox &quot;180 degrees=&quot;+str(180*Deg2Rad)+&quot; radians.&quot;</TT></P><P>&#160;&#160;As you can see, multiplying a number by our special variable (Deg2Rad)converts it from degrees to radians. Why does multipying a number by <TT>ATan(1)/45</TT>work? I have no clue, but it does, and that's what matters. So, armed with this knowledge,we can now make a program that draws a point at 47.3 degrees on a circle with a radiusof 50.</P><P>&#160;&#160;First, make a window, and put a canvas in it. Make sure the canvasis at least 120x120. Double click the canvas to bring up the code editor, and typethis in:</P><P><TT>Sub Paint(g as graphics)<BR>&#160;&#160;Dim Deg2Rad, X, Y as Double<BR>&#160;&#160;Deg2Rad=ATan(1)/45<BR>&#160;&#160;X=Sin(47.3*D)*50+60<BR>&#160;&#160;Y=Cos(47.3*D)*50+60<BR>&#160;&#160;g.DrawOval 10,10,100,100<BR>g.DrawLine 60,60,X,Y<BR>End Sub</TT></P><P>&#160;&#160;Yes, that does deserve some explaining. The only two lines that shouldbe new to you are these:</P><P><TT>&#160;&#160;X=Sin(47.3*D)*50+60<BR>&#160;&#160;Y=Cos(47.3*D)*50+60</TT></P><P>&#160;&#160;We know that Sin returns the X coordinate of a degree. We also knowthat it uses radians. So, <TT>47.3*D</TT> takes 47.3 degrees, and converts it toradians, so that the Sin function can use it. The same is true for the second line.</P><P>&#160;&#160;After working out the *D and Cos/Sin parts of the lines, we're leftwith this:</P><P>&#160;&#160;<TT>X=0.734916*50+60<BR>&#160;&#160;Y=0.67816*50+60</TT></P><P>&#160;&#160;As you can see, RB now multiplies each number by 50. This is becauseour circle has a radius of 50. Finally, 60 is added to each number, so that the centerof the circle is in the center of the canvas.</P><P>&#160;&#160;If you've done everything right, your program will look like this:</P><CENTER><P><IMG SRC="trigwin1.gif" WIDTH="148" HEIGHT="164" ALIGN="BOTTOM" BORDER="0"></P></CENTER><P>&#160;&#160;Hmm. That's not where we said 47.3 degrees was earlier. It shouldbe farther up on the circle. Well, there IS a reason for this. On a computer, thefarther down you go, the higher the Y coordinate gets. For trig, it's just the opposite.So, to compensate for that, just change the Cos line in the program to this:</P><P><TT>&#160;&#160;Y=-Cos(47.3*D)*50+60</TT></P><P>&#160;&#160;The &quot;-&quot; will flip it upside-down, and into place, like so:</P><CENTER><P>&#160;&#160;<IMG SRC="trigwin2.gif" WIDTH="122" HEIGHT="123" ALIGN="BOTTOM" BORDER="1"></P></CENTER><P>&#160;&#160;And that's it. How is this useful? Quite simply, anything that involvesrotation is impossible without it.</P><P>&#160;&#160;There's also one more formula you should know. If (OX, OY) is thecenter, and X, Y is the cursor's position, this code:</P><P><TT>&#160;&#160;atan((X-OX)/(Y-OY))/deg2rad</TT></P><P>&#160; Will give you the number of degrees to the cursor. Pretty useful stuff.</BODY></HTML>