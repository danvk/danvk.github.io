<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><HTML><HEAD>	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">	<TITLE>Gestalts</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><P><FONT SIZE="5">Using Gestalts in RB<BR>By Dan Vanderkam<BR></FONT>Note: 2.0.1a2 or later is needed to use this article.</P><P><FONT SIZE="2">&#160;&#160;</FONT>No, it's not just a funny word. Gestalts area way that a program can ask for certain info about a computer from the system. Forexample, you could get the version of QuickTime, or the system bus's clock speedusing Gestalts. They're quite useful.</P><P>&#160;&#160;To access Gestalts, RB uses a simple method: System.Gestalt. Thisfunction returns a boolean (indicating whether the gestalt exists or not), and ittakes two parameters: the four letter code of the gestalt, and an integer that willcontain the info.</P><P>&#160;&#160;For example, to get the clock speed of the computer, we might usethis code:</P><P><TT>Dim speed as integer<BR>if System.Gestalt(&quot;pclk&quot;, speed) then<BR>&#160;&#160;msgbox &quot;Your system runs at &quot;+str(speed)+&quot; Hertz.&quot;<BR>else<BR>&#160;&#160;msgbox &quot;Something is seriously bizarre with your computer.&quot;<BR>End if</TT></P><P>&#160;&#160;When I run this code, RB displays the message &quot;Your system runsat 2.40000000e+8 Hertz.&quot; If you multiply out that number, you'll find that it's240 million. 240 million Hertz is 240Mhz, which is what my computer runs at.</P><P>&#160;&#160;However, the numbers that are given by System.Gestalt aren't alwaysso nice. Many Gestalts return a version number. For example, if we replaced <TT>System.Gestalt(&quot;pclk&quot;,speed)</TT> with <TT>System.Gestalt(&quot;qtim&quot;, speed)</TT>, we'd be told thatthe QuickTime version is 67133473. Oddly enough, this number represents Quicktime4.0.0. However, we we convert this number into hexadecimal, things become clearer.In hex, this number is 4006021. So, the first number of the version in Hex is themajor release. The second is the minor release, and the third is the maintenancerelease number. So, this routine should tell us the version of QuickTime in ordinaryenglish:</P><P><TT>Dim Version as integer, vers as string<BR>dim major, minor, maint as string<BR>if System.Gestalt(&quot;qtim&quot;,version) then<BR>vers=hex(version)<BR>major=mid(vers, 1, 1)<BR>&#160;&#160;minor=mid(vers, 2, 1)<BR>&#160;&#160;maint=mid(vers, 3, 1)<BR>&#160;&#160;MsgBox &quot;QuickTime version is &quot;+major+&quot;.&quot;+minor+&quot;.&quot;+maint+&quot;.&quot;<BR>else<BR>&#160;&#160;MsgBox &quot;QuickTime isn't installed.&quot;<BR>end if</TT></P><P>&#160;&#160;That system for using versions isn't true only for QuickTime. It alsoworks for almost anything else that returns a version.</P><P>&#160;&#160;Now that you know how to use a Gestalt in your program, here's a listof codes you might want to try:</P><P><TABLE BORDER="0" WIDTH="100%">	<TR>		<TD WIDTH="12%"><B>Code</B></TD>		<TD WIDTH="88%"><B>Description</B></TD>	</TR>	<TR>		<TD WIDTH="12%"><B>qtim</B></TD>		<TD WIDTH="88%">Returns the QuickTime version</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>ag_v</B></TD>		<TD WIDTH="88%">Returns the version of AppleGuide (if it's present)</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>appr</B></TD>		<TD WIDTH="88%">Appearance manager. Returns 1 if it's there, 0 if it's not.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>apvr</B></TD>		<TD WIDTH="88%">Returns Appearance Manager version.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>ascr/ascv</B></TD>		<TD WIDTH="88%">AppleScript present/version number</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>cash</B></TD>		<TD WIDTH="88%">The amount of RAM given to the disk cache (in bytes)</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>cmnu</B></TD>		<TD WIDTH="88%">The Gestalt function returns true if contextual menus are installed, false if they're			not.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>cpkr</B></TD>		<TD WIDTH="88%">Returns the color picker version.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>doub</B></TD>		<TD WIDTH="88%">Returns the version of WorldScript (if installed)</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>dkpx</B></TD>		<TD WIDTH="88%">Returns the version of the Desktop Pictures control panel (if installed)</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>micn</B></TD>		<TD WIDTH="88%">Returns the computer's icon family ID. All icons are generic after System 7.5</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>nvsv</B></TD>		<TD WIDTH="88%">Gestalt returns true if NavServices are present, false if they aren't</TD>	</TR>	<TR>		<TD WIDTH="12%" HEIGHT="13"><B>otvr</B></TD>		<TD WIDTH="88%" HEIGHT="13">Returns the Open Transport version.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>thds</B></TD>		<TD WIDTH="88%">Gestalt returns true if the Thread Manager is present, false if it isn't.</TD>	</TR>	<TR>		<TD COLSPAN="2"><HR SIZE="1" NOSHADE>		</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>usb</B></TD>		<TD WIDTH="88%">Gestalt returns true if USB abilities are available, false if they aren't.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>rom</B></TD>		<TD WIDTH="88%">Returns the amount of ROM in bytes.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>pclk</B></TD>		<TD WIDTH="88%">Returns the processor speed in Hertz (1,000,000 Hz=1Mhz)</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>mach</B></TD>		<TD WIDTH="88%">Returns the machine type (ie, PowerBook 3400c). <A HREF="http://www.bio.vu.nl/home/rgaros/gestalt/chapters/ch-5.html">Look			this up</A> for machine types.</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>ram /lram</B></TD>		<TD WIDTH="88%">The amount of RAM/Logical RAM (in bytes)</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>fpu</B></TD>		<TD WIDTH="88%">Returns 0 if no FPU, higher than that if there is. Be sure to write 'fpu '</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>bclk</B></TD>		<TD WIDTH="88%">Returns the bus speed in Hertz (1,000,000 Hz=1 Mhz)</TD>	</TR>	<TR>		<TD WIDTH="12%"><B>cput</B></TD>		<TD WIDTH="88%">Returns the CPU type as a special number:<BR>			<BR>						<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="0" WIDTH="100%">				<TR>					<TD WIDTH="25%">• 68000 = 0</TD>					<TD WIDTH="27%">• 68040 = 4</TD>					<TD WIDTH="48%">• PPC 603e = 262</TD>				</TR>				<TR>					<TD WIDTH="25%">• 68010 = 1</TD>					<TD WIDTH="27%">• PPC 601 = 257</TD>					<TD WIDTH="48%">• PPC 603ev = 263</TD>				</TR>				<TR>					<TD WIDTH="25%">• 68020 = 2</TD>					<TD WIDTH="27%">• PPC 603 = 259</TD>					<TD WIDTH="48%">• PPC 604e = 265</TD>				</TR>				<TR>					<TD WIDTH="25%">• 68030 = 3</TD>					<TD WIDTH="27%">• PPC 604 = 260</TD>					<TD WIDTH="48%">• PPC 604ev = 266</TD>				</TR>				<TR>					<TD WIDTH="25%">&#160;</TD>					<TD WIDTH="27%">&#160;</TD>					<TD WIDTH="48%">• PPC 750 (G3) = 264</TD>				</TR>			</TABLE>		</TD>	</TR></TABLE></P><P>&#160;&#160;For a much more complete list of codes, check out the <A HREF="http://www.bio.vu.nl/home/rgaros/gestalt/index.html">GestaltSelectors List 4.3.2 Overview</A> page, which has a comprehensive list of all theknown four letter gestalt codes. The table I've included here is just a small helpingof what's on that page. Enjoy!</BODY></HTML>