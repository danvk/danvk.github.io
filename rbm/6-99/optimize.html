<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><HTML><HEAD>	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">	<TITLE>How To Optimize Your Code</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><P>Optimizing Code (How to manage your RAM)</P><P>By Samad</P><P>&quot;And yes, Bill Gates does sleep with his glasses on.&quot; (From Linux forDummies)</P><P>Wife of Bill Gates: &quot;Hey Bill, what are you doing on &lt;http://store.apple.com&gt;?&quot;,Bill: &quot;I'm gonna buy an iMa... err, nothing.&quot;</P><P>&#160;</P><P><B>Why should I even bother to optimize my code?</B></P><P>You want to satisfy your user. That's the point behind everything in programming- you want to satisfy your user. Without the user, who will use your program? Simplicityand speed satisfies the user. This guide will only focus on how to speed up yourprograms by properly managing your RAM.</P><P>&#160;</P><P><B>Understanding Variables</B></P><P>Variables are the only main reason why RAM is there. When you launch an application,the OS will give the application a certain amount of RAM. This is called RAM allocation.Here is a small diagram to better illustrate the situation:</P><P><IMG SRC="image2.gif" WIDTH="441" HEIGHT="398" ALIGN="BOTTOM" BORDER="0" NATURALSIZEFLAG="3"></P><P>Now what exactly would SimpleText store in it's RAM allocation? It'll store temporarydata, known as variables. The variables might contain the picture that the user mighthave opened, the location of the file that is opened, what type of computer it isfor future reference, etc. However, variables are temporary. When we quit the program,all of its RAM allocation is lost and set aside into the Free RAM. When the nextprogram opens, it'll take a certain chunk of the Free RAM. RAM itself is temporary,when you restart or shutdown the computer, all of the RAM's data is lost. With properusage of variables, you could speed up your programs and save a little extra RAMfor Grandma.</P><P>&#160;</P><P><B>When &amp; Where You Should Optimize Your Code</B></P><P>Always always always optimize when your done programming all your code. Optimizationcan cause confusion in your code and becomes very hard to optimize later after youfind out that there is a bug that deletes the System Folder then deletes a REALbasicproject that you have been working ever since Steve Wozniak made the Blue Box. AFTERyou are done programming your code, optimizing can occur usually in Do, For, or Whilestatements or anything that's repetitive. If your program doesn't have any repetitivestatements then you really don't need to optimize your code. However, you could saveRAM if your programs are not repetitive.</P><P>&#160;</P><P><B>How To Optimize Your Code</B></P><P>Like I said before, you can mostly do your optimizing in repetitive statements.There are two things you can do in repetitive statements to make them faster:</P><P>&#160;</P><UL>	<LI>Use Less Variables	<LI>Use More Variables</UL><P>&#160;</P><P>You might be thinking, &quot;What the heck?!?!&quot;. After reading this, it'llbe more clear to you.</P><P>&#160;</P><UL>	<LI>Using Less Variables	<LI>Use variables that are redundant. Lets look at this code for a second:</UL><P>&#160;</P><DL>	<DT><TT>Dim TheFolder as FolderItem</TT></DT>	<DT><TT>Dim TheName,AbPath as string</TT></DT>	<DT><TT>Dim i as integer</TT></DT>	<DT><TT>TheFolder = GetFolderItem(&quot;My Hard Drive:&quot;)</TT></DT>	<DT><TT>TheName = TheFolder.Name</TT></DT>	<DT><TT>AbPath = TheFolder.AbsolutePath</TT></DT>	<DT><TT>Window1.Title = AbPath</TT></DT>	<DT><TT>for i = 1 to TheFolder.Count</TT></DT>	<DT><TT>ListBox1.AddRow TheFolder.Item(i) + &quot; of &quot; + TheName</TT></DT>	<DT><TT>next</TT></DT></DL><P>&#160;</P><P>We could eliminate the AbPath variable altogether. We could just say:</P><P>&#160;</P><DL>	<DT><TT>Dim TheFolder as FolderItem</TT><BR>	<TT>Dim TheName as string</TT><BR>	<TT>Dim i as integer</TT></DT>	<DT><TT>TheFolder = GetFolderItem(&quot;My Hard Drive:&quot;)</TT></DT>	<DT><TT>TheName = TheFolder.Name</TT></DT>	<DT><TT>Window1.Title = TheFolder.AbsolutePath</TT></DT>	<DT><TT>for i = 1 to TheFolder.Count</TT></DT>	<DT><TT>ListBox1.AddRow TheFolder.Item(i) + &quot; of &quot; + TheName</TT></DT>	<DT><TT>next</TT></DT></DL><P>&#160;</P><P>Remember system of equations in Algebra? Well, think of it that way. Instead ofsaying:</P><P><TT>x=y+1; x+y=10</TT></P><P>We could just say:</P><P><TT>y+1+y=10 (or 2y+1=10).</TT></P><P>&#160;</P><P><I>Summary</I></P><P>We should use less variables when:</P><UL>	<LI>We have variables that are redundant</UL><P>So, using less variables results:</P><UL>	<LI>Perhaps Faster Code	<LI>More RAM</UL><P>&#160;</P><P>Using More Variables</P><P>Lets look back at the example that we used before:</P><P>&#160;</P><DL>	<DT><TT>Dim TheFolder as FolderItem</TT></DT>	<DT><TT>Dim i as integer</TT></DT>	<DT><TT>TheFolder = GetFolderItem(&quot;My Hard Drive:&quot;)</TT></DT>	<DT><TT>Window1.Title = TheFolder.AbsolutePath</TT></DT>	<DT><TT>for i = 1 to TheFolder.Count</TT></DT>	<DT><TT>ListBox1.AddRow TheFolder.Item(i) + &quot; of &quot; + TheFolder.Name</TT></DT>	<DT><TT>next</TT></DT></DL><P>&#160;</P><P>If we examine the code, the programmer took out the variable TheName altogether.This will definitely cause the program to run slower. Why? Because the CPU has torecompute the statement &quot;TheFolder.Name&quot; over and over and over. &quot;TheFolder.Name&quot;does not have to be recomputed over and over. The answer will always be the sameso it is useless to recompute it. Therefore, it is more proper to use a variablein this case. So all we have to do is set up a variable that will be computed onlyonce and will be &quot;TheFolder.Name&quot;. So the code could end up to be:</P><P>&#160;</P><DL>	<DT><TT>Dim TheFolder as FolderItem</TT></DT>	<DT><TT>Dim TheName as string</TT></DT>	<DT><TT>Dim i as integer</TT></DT>	<DT><TT>TheFolder = GetFolderItem(&quot;My Hard Drive:&quot;)</TT></DT>	<DT><TT>TheName = TheFolder.Name</TT></DT>	<DT><TT>Window1.Title = TheFolder.AbsolutePath</TT></DT>	<DT><TT>for i = 1 to TheFolder.Count</TT></DT>	<DT><TT>ListBox1.AddRow TheFolder.Item(i) + &quot; of &quot; + TheName</TT></DT>	<DT><TT>next</TT></DT></DL><P>&#160;</P><P>If we have the CPU compute the same statement over and over, it'll be just a waste.It's like saying:</P><P>&#160;</P><DL>	<DT><TT>Dim TheNum, i as integer</TT></DT>	<DT><TT>for i = 0 to 10000000000000</TT></DT>	<DT><TT>TheNum = 1+1</TT></DT>	<DT><TT>next</TT></DT>	<DT><TT>return TheNum</TT></DT></DL><P>&#160;</P><P>We know that TheNum will come out to be 2. So we do not have to recompute it overand over.</P><P>&#160;</P><P><I>Summary</I></P><P>We Should Use More Variables When:</P><UL>	<LI>We don't want to recompute a statement over and over that will have the same	result</UL><P>&#160;</P><P>Using More Variables Properly:</P><UL>	<LI>We will have much faster code</UL><P>&#160;</P><P><B>Preserving RAM</B></P><P>If we use less variables properly then we get more RAM for our programs to fiddlewith and our programs will be much more efficent. Lets look at this code:</P><P>&#160;</P><DL>	<DT><TT>Dim TheFile as FolderItem</TT></DT>	<DT><TT>Dim ThePict as Picture</TT></DT>	<DT><TT>TheFile = GetFolderItem(&quot;My Hard Drive:My Picture&quot;)</TT></DT>	<DT><TT>ThePict = TheFile.OpenAsPicture</TT><BR>	<TT>return ThePict</TT></DT></DL><P>&#160;</P><P>We could just say:</P><P>&#160;</P><DL>	<DT><TT>Dim ThePict as Picture</TT></DT>	<DT><TT>ThePict = GetFolderItem(&quot;My Hard Drive:My Picture&quot;).OpenAsPicture</TT></DT>	<DT><TT>return ThePict</TT></DT></DL><P>&#160;</P><P>Like I said before, it's like the system of equations in Algebra. However, thecode:</P><P>&#160;</P><DL>	<DT><TT>Dim TheFile as FolderItem</TT></DT>	<DT><TT>Dim ThePict as Picture</TT></DT>	<DT><TT>TheFile = GetOpenFolderItem(&quot;&quot;,&quot;*/*&quot;)</TT></DT>	<DT><TT>ThePict = TheFile.OpenAsPicture</TT></DT>	<DT><TT>return ThePict</TT></DT></DL><P>&#160;</P><P>We should not try to preserve RAM. Why? Say if the user clicks &quot;Cancel&quot;when the GetOpenFolderItem dialog shows. That means TheFile will become Nil. If wetry to do TheFile.OpenAsPicture when TheFile is Nil then the program will crash.</P><P>&#160;</P><P>Here is another situation. Lets say if you are going to write an example for otherprogrammers to use. Should the programmer use this code:</P><P>&#160;</P><DL>	<DT><TT>Dim TheFile as FolderItem</TT></DT>	<DT><TT>Dim ThePict as Picture</TT></DT>	<DT><TT>TheFile = GetFolderItem(&quot;My Hard Drive:My Picture&quot;)</TT></DT>	<DT><TT>ThePict = TheFile.OpenAsPicture</TT></DT>	<DT><TT>return ThePict</TT></DT></DL><P>&#160;</P><P>Or this code:</P><P>&#160;</P><DL>	<DT><TT>Dim ThePict as Picture</TT></DT>	<DT><TT>ThePict = GetFolderItem(&quot;My Hard Drive:My Picture&quot;).OpenAsPicture</TT></DT>	<DT><TT>return ThePict</TT></DT></DL><P>&#160;</P><P>The programmer should use the first set of code. Since it is an example, otherpeople are going to look at it. It wil be more confusing if programmers look at thesecond set of code rather than the first. In other words, it is okay to use morevariables when you are writing examples.</P><P>&#160;</P><P><I>Summary</I></P><P>When To Use Less Variables:</P><UL>	<LI>When we can &quot;shortcut&quot; it (like the system of equations).</UL><P>Do Not Use Less Variables:</P><UL>	<LI>When we write examples</UL><P>Using Less Variables Results:</P><UL>	<LI>More RAM</UL></BODY></HTML>