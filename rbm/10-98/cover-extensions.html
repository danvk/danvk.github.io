<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><HTML><HEAD>	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">	<TITLE>Cover Story—Extensions</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><P><FONT SIZE="7">Extensions, <IMG SRC="extensions.jpeg" WIDTH="232" HEIGHT="80"ALIGN="BOTTOM" BORDER="0"></FONT></P><P><FONT SIZE="4"><B>Cover Story</B></FONT></P><P><FONT SIZE="4"><B>&#160;&#160;</B></FONT>If you've used a mac for any amount oftime, you probably know what an extension is. They go in the extensions folder, andmodify some part of your system. Some might add a screensaver. Other might anti-aliasall of the text you type.</P><P>&#160;&#160;Though you can't make this type of extension in Realbasic (at leastnot yet), you can make another type of extension. It doesn't modify anything, butit has a constant presence.</P><P><FONT SIZE="4"><B>&#160;What we'll make</B></FONT></P><P>&#160;&#160;If you hadn't guessed by now, this cover story shows you how to makean extension in RB. Our extension will be a Magic 8-Ball. It will consist of a windowthat has one static text object on it. It will remain out of view, but when a key(F10) is pressed, it will appear, and tell us our fortunes. When you click on a buttoncalled &quot;Be Gone!&quot;, it will disappear.</P><P>&#160;<FONT SIZE="4"><B>Getting Started</B></FONT></P><P>&#160;&#160;To get started, we'll need to make a window. Here's what it shouldlook like:</P><P>&#160;&#160;<IMG SRC="window.gif" WIDTH="379" HEIGHT="319" ALIGN="BOTTOM" BORDER="0"></P><P>&#160;&#160;Note that the window's type is global floater.</P><P>&#160;&#160;<FONT SIZE="4"><B>The Magic 8-Ball</B></FONT></P><P>&#160;&#160;Naturally, a main part of the magic 8-ball program is creating a randomresponse. Let's use these:</P><UL>	<LI>Yes	<LI>No	<LI>Maybe	<LI>I think you know the answer to that	<LI>How would I know? I'm just a computer!	<LI>Try again	<LI>I refuse to answer that question	<LI>Get real.	<LI>Most definitely</UL><P>&#160;&#160;To do that, we'll need to make a method. It should be called &quot;GetResponse&quot;,and should have no parameters. It will return a string.</P><P>&#160;&#160;So, with no further ado, here's the code:</P><P><IMG SRC="EightBallCode.gif" WIDTH="467" HEIGHT="322" ALIGN="BOTTOM" BORDER="1"></P><P>&#160;&#160;The second line sets the value of <TT>n</TT> to a random number between1 and 9. The rest of the lines return a value based on this number.</P><P>&#160;&#160;So, the statement <TT>MsgBox GetResponse</TT> could display a messageon the screen with any of the nine possible replies.</P><P>&#160;&#160;<FONT SIZE="4"><B>Limitations of extensions</B></FONT></P><P><FONT SIZE="5">&#160;</FONT>Even though you can do a lot with them, extensionsmade in Realbasic are <B>very</B> limited. Here are the specs of what you can andcannot have:</P><P>&#160;&#160;• They cannot have a menu<BR>&#160;&#160;• They can only use global floaters<BR>&#160;&#160;• They can't put a dialog on the screen</P><P>&#160;&#160;With these limitations in mind, there actually ARE a lot of thingsyou can do with an extension (like our 8-ball, which conforms to all of these).</P><P><FONT SIZE="4"><B>&#160;&#160;Hiding and showing the 8-ball</B></FONT></P><P>&#160;&#160;Since people won't want to have the 8-ball window open all the time,we'll want to add the ability to hide it. Actually, we won't REALLY be hiding it–we'llonly move it off the left edge of the screen. To hide it, we'll move its left edgeto -1000, and to show it, we'll move the left edge to 200.</P><P>&#160;&#160;Here are the routines to show and hide the windows:</P><P><FONT COLOR="#003399"><TT>Sub</TT></FONT><TT> HideWindow()<BR>&#160;&#160;</TT><FONT COLOR="#003399"><TT>me</TT></FONT><TT>.Left=-1000<BR></TT><FONT COLOR="#003399"><TT>End Sub</TT></FONT><TT><BR><BR></TT><FONT COLOR="#003399"><TT>Sub</TT></FONT><TT> ShowWindow()<BR>StaticText1.Text=GetResponse<BR>&#160;&#160;</TT><FONT COLOR="#003399"><TT>me</TT></FONT><TT>.Left=100<BR></TT><FONT COLOR="#003399"><TT>End Sub</TT></FONT></P><P>&#160;&#160;The first routine is fairly self-explanatory. The second one doestwo things however: it sets the label to a random phrase, <B>and</B> shows the window.</P><P>&#160;&#160;<FONT SIZE="4"><B>Checking for the key to be down</B></FONT></P><P>&#160;&#160;We still need a way to show and hide the window! In the beginningof this tutorial, we said that they F10 key would show and hide the window. Yourfirst reaction would probably be to use the window's KeyDown event. After all, we<B>are</B> trapping a keypress. However, since this event only fires when the windowis in the foreground, and extensions are never in the foreground, this won't work.</P><P>&#160;&#160;Is there another way? This would be a pretty dumb tutorial if therewasn't! Believe it or not, the best way to do this is to use a timer. The timer periodicallychecks to see whether or not F10 is currently pressed. If it is, and the window isoff the screen, the timer shows the window with a new prediction. Here's how thecode:</P><P><IMG SRC="showcode.gif" WIDTH="367" HEIGHT="113" ALIGN="BOTTOM" BORDER="0"></P><P>&#160;This code certainly warrants an explanation, so you'll get one.</P><P>•&#160;&#160;<TT>If Keyboard.AsyncKeyDown(109) then</TT></P><P>This line checks to see wether the F10 key is depressed. The Keyboard object's<TT>AsyncKeyDown</TT> method uses the same numbering system as the SpriteSurface.In this system, the F10 key's ID is 109. So, if the F10 key is down, we keep on goingto...</P><P>•&#160;&#160;<TT>If self.Left&lt;0 then</TT></P><P>&#160;&#160;This line checks to see if the window is visible. Before you startgetting confused, look back a bit. We decided that in order to hide the window, we'dmove its left side to -1000 (which is off the screen). If the window is hidden, itsLeft is less than 0. So, if the window is not visible, we go on to...</P><P>•&#160;&#160;<TT>ShowInsult</TT></P><P>&#160;&#160;From here on out, the code is stuff we've already seen. This commandshows the window, and generates an insult. The rest of the codes are just de-nesters.(Yes, that <B>is</B> a word).</P><P>&#160;&#160;Also, if you run the program, and notice that the window isn't NEARLYas responsive in the background, you should know that this isn't your fault. In general,when it's in the background, a timer fires only about a third as often as it usuallywould. If the unresponsiveness annoys you, by all means, <A HREF="mailto:bugs@realsoftware.com">e-mailREAL Software</A>. This problem also affects threads.</P><P><FONT SIZE="4"><B>&#160;&#160;Extension vs. Application</B></FONT></P><P>&#160;&#160;In a sense, you're done! However, this is only true if you want your8-ball to be a normal application, which we don't. We're greedy: we want an extension.So, we still have a few short steps left that make a project a system extension.</P><P>&#160;&#160;<B>Step #1: Compile</B>. This makes the project a double-clickableapplication program.</P><P>&#160;&#160;<B>Step #2: Open in Resourcer</B>. ResEdit also works.</P><P>&#160;&#160;<B>Step #3: Change the type</B>. Change the program's type code from&quot;APPL&quot; to &quot;appe&quot;. This converts it to a system extension, likeso:</P><P><IMG SRC="changetype.gif" WIDTH="387" HEIGHT="63" ALIGN="BOTTOM" BORDER="1"></P><P>&#160;&#160;<B>Step #4: Make it a background task.</B> Double-Click the newlydubbed system extension's SIZE resource, and check the &quot;Background Task&quot;box, like so:</P><P><IMG SRC="backgroundtask.gif" WIDTH="421" HEIGHT="199" ALIGN="BOTTOM" BORDER="1">&#160;&#160;</P><P>&#160;&#160;<B>Step #5: Last but not least...</B> Save the extension, drag itinto the extensions folder, and restart.</P><P><FONT SIZE="4"><B>&#160;&#160;In Conclusion...</B></FONT></P><P><IMG SRC="image.gif" WIDTH="182" HEIGHT="89" ALIGN="RIGHT" BORDER="0">&#160;&#160;Wenow have a system extension that looks somewhat like the window to the right. Sure,it won't sell as many copies as Kaleidoscope, but you've made it! You're now a utilitydeveloper!</P><P>&#160;&#160;Also, as an added bonus, the extension will be compatible with MacOS X, since this is what all extensions will be like in it!<BR clear = "right"></P><P>&#160;&#160;In the future, the abilities of RB-made applications will only expand.If timers fire correctly in the background, and more functions that control aspectsof the system are added, then these extensions could become significantly more powerful.In fact, if only a few more commands were added, you could write a macro utility!(not that it'd be that great...)</P><P>&#160;&#160;As usual, there are many other things you could do to this 8-Ball.Here are a few that you might want to try if you've been truly swept off your feetby it:</P><UL>	<LI>Make F10 show <B>and</B> hide the window, not just show it.	<LI>Allow the user to add their own custom responses.	<LI>Show a secret about box if you Cmd-Opt click the &quot;Be Gone!&quot; button	<LI>Add a nifty picture sequence of the ball being rolled.</UL></BODY></HTML>