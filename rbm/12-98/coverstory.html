<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><HTML><HEAD>	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">	<TITLE>Cover Story</TITLE></HEAD><BODY BGCOLOR="#FFFFFF"><P><FONT SIZE="7"><TT>Cover Story<BR>New QuickTime features</TT></FONT></P><P><FONT SIZE="4">&#160;&#160;Like it or not, you have to admit that QuickTime isone of Apple's most impressive and widespread technologies. However, up until recently,you could do very little with it.</FONT></P><P><FONT SIZE="4">&#160;&#160;In the past, there were only two things you could dowith movies: load them to a movie object, and put them into a MoviePlayer control.Not so any more!</FONT></P><P><FONT SIZE="4">&#160;&#160;Beginning with DR2r18, RB has some genuine power overQuickTime. This tutorial will show you how to use this to create a smooth transitionbetween two different pictures, and save it as a compressed movie.</FONT></P><P><FONT SIZE="4">&#160;&#160;In order to give you this control, RB uses severalclasses and methods. Here they are:</FONT></P><P><TABLE BORDER="0" WIDTH="100%">	<TR>		<TD WIDTH="50%"><FONT SIZE="4"><B>Classes</B></FONT></TD>		<TD WIDTH="50%">&#160;</TD>	</TR>	<TR>		<TD WIDTH="50%">Movie</TD>		<TD WIDTH="50%">This isn't new, but it has an important new method: NewVideoTrack.</TD>	</TR>	<TR>		<TD WIDTH="50%">QTEffect</TD>		<TD WIDTH="50%">This contains a QT3 transition</TD>	</TR>	<TR>		<TD WIDTH="50%">QTEffectSequence</TD>		<TD WIDTH="50%">This is a sequence of frames based off a QuickTime effect. You can get individual			frames in a transition from this.</TD>	</TR>	<TR>		<TD WIDTH="50%">QTVideoTrack</TD>		<TD WIDTH="50%">This is a video track from a QT Movie. You'll use this to compress the movie, and			to add individual frames</TD>	</TR>	<TR>		<TD WIDTH="50%"><FONT SIZE="4"><B>Methods</B></FONT></TD>		<TD WIDTH="50%">&#160;</TD>	</TR>	<TR>		<TD WIDTH="50%">GetQTCrossFadeEffect</TD>		<TD WIDTH="50%">This returns a QTEffect object that gradually fades from one image to another. Very,			very useful.</TD>	</TR>	<TR>		<TD WIDTH="50%">GetQTSMPTEeffect</TD>		<TD WIDTH="50%">This returns a standard SMPTE QuickTime effect based off an ID (check out <A HREF="smpte.html">this			list</A> for details).</TD>	</TR></TABLE></P><P><IMG SRC="moviemaker.gif" WIDTH="288" HEIGHT="347" ALIGN="RIGHT" BORDER="0"><B>Settingup the interface</B></P><P><TT>&#160;&#160;</TT>To start off, make a window with two canvas controls on theleft, a movie player control on the right, and a big button that says &quot;MakeMovie&quot; on the lower-right, like the window to the right. If you've never useda movieplayer control before, its icon on the toolbar is 11th from the top, and isin the second column. It looks like this: <IMG SRC="image35.gif" WIDTH="28" HEIGHT="24"ALIGN="BOTTOM" BORDER="0"></P><P>&#160; The two canvas controls will hold the two pictures that we want to makea transition between. The &quot;Make Movie&quot; button will make the movie (howintuitive...), and the movieplayer control will show the movie. Clever, eh?<BR clear = "right"></P><P><B>Setting up the code<IMG SRC="Pic1Pic2.gif" WIDTH="138" HEIGHT="160" ALIGN="RIGHT"BORDER="1"></B></P><P>&#160;&#160;First off, we'll need to create two picture variables to hold thetwo base images. We'll call these Pic1, and Pic2. Open up the code editor for thewindow, and add them, like so:&#160;&#160;<BR clear = "right"> <B>Getting the pictures</B></P><P>&#160;&#160;Before we can make a transition between Pic1 and Pic2, we'll needto provide a way to decide what Pic1 and Pic2 are! The way we'll do this is simple:When a user clicks one of the canvases, an open dialog pops up. This lets them selecta picture. Here's how to do it...</P><P>&#160;&#160;First of all, open up the Types dialog by choosing &quot;File Types...&quot;from the Edit menu. You'll see a window with an Add button at the bottom left. Clickit. Then, type this in the window that shows up:</P><P><IMG SRC="picwin.gif" WIDTH="373" HEIGHT="224" ALIGN="BOTTOM" BORDER="0"></P><P>&#160;&#160;After you're done with that, click OK on both the Add File dialog,and the File Types dialog.</P><P>&#160;&#160;Now, we'll add the code to select the pictures.</P><P>&#160;&#160;In Canvas1's MouseDown event, put the following code:</P><P><TT>Function MouseDown(X as integer,Y as integer) as boolean<BR>&#160;&#160;Dim f as folderItem<BR>&#160;&#160;f=GetOpenFolderItem(&quot;Picture&quot;)<BR>&#160;&#160;if f&lt;&gt;nil then<BR>&#160;&#160;&#160;&#160;pic1=f.OpenAsPicture<BR>&#160;&#160;&#160;&#160;me.Backdrop=pic1<BR>&#160;&#160;end if</TT><BR><TT>End Function</TT></P><P>&#160;&#160;In the MouseDown event for Canvas2, put this:</P><P><TT>Function MouseDown(X as integer,Y as integer) as boolean<BR>&#160;&#160;Dim f as folderItem<BR>&#160;&#160;f=GetOpenFolderItem(&quot;Picture&quot;)<BR>&#160;&#160;if f&lt;&gt;nil then<BR>&#160;&#160;&#160;&#160;pic2=f.OpenAsPicture<BR>&#160;&#160;&#160;&#160;me.Backdrop=pic2<BR>&#160;&#160;end if</TT><BR><TT>End Function</TT></P><P>These bits of code are fairly simple. First, they put up an Open box. Then, theycheck to see if you clicked cancel. If you didn't, then they put the picture in Pic1or Pic2 (depending on which Canvas), and put that picture in their backdrop, so thatyou can see it.</P><P><B>Making the transition</B></P><P>&#160;&#160;Now comes the interesting part—making a transition. Here's how we'lldo it:</P><OL>	<LI>First off, we'll need to make a movie file. We'll call it &quot;RB Monthly Rules&quot;	<LI>Next, we'll need to add a video track to it. We'll call the VideoTrack &quot;v&quot;	<LI>After that, we'll need to get compression settings. We can do this with the videotrack's	SelectCompressionSettings method.	<LI>Next off, we'll make a QTEffectSequence based off the two pictures, and a CrossFadeEffect	that's 30 frames long.	<LI>Finally, we'll add each frame from the transition to the movie, and put the finished	product in the MoviePlayer.</OL><P>&#160;&#160;Sound complicated? After you work with it for a while, you'll findthat it's really quite intuitive.</P><P><B>The Variables</B></P><P>&#160;&#160;This routine will have several variables (they're mentioned in theprevious section). Here's what you'll want to start off PushButton1's Action eventwith:</P><P><TT>dim m as movie<BR>dim f as folderitem<BR>dim t as QTEffectSequence<BR>Dim v as QTVideoTrack<BR>dim i as integer<BR>dim b as boolean</TT></P><P><B>Making the movie</B></P><P>&#160;&#160;To make the movie file, we'll need to get a folderitem, and a movieobject. It's fairly simple. Just these lines of code:</P><P><TT>f=GetFolderitem(&quot;RB Monthly Rules&quot;)<BR>m=f.CreateMovie</TT></P><P>&#160;&#160;Like I said, pretty darned simple!</P><P><B>Making a Video Track</B></P><P>&#160;&#160;Anyone who's used PhotoShop should be instantly at home with QuickTime'sVideo Tracks. They're just like layers. If you <B>haven't</B> used PhotoShop, thenthey're still fairly simple. A Video Track contains a bunch of images that are inthe movie. Movies can have multiple video tracks, but there aren't a whole lot ofuses for this outside of Movie making programs like Premiere.</P><P>&#160;&#160;Also, since we'll want to compress this video, we must call the videotrack's<TT>SelectCompressionSettings</TT> method. This will cause a standard &quot;selectcompression settings&quot; dialog to pop up.</P><P>&#160;&#160;Anyway, here's the code to get the video track which, in case you'veforgotten, is called <TT>v</TT>.</P><P><TT>v=m.NewVideoTrack(pic1.Width,pic1.Height,1)<BR>b=v.SelectCompressionSettings</TT></P><P>&#160;&#160;The first parameter of the NewVideoTrack method is the width of thevideotrack. Since we want it to be the same size as the picture, we use pic1.width.The same is true for the second parameter, which is the height. The third parameteris the &quot;timeScale&quot;, but I have no idea what it does (experienced QT people,<A HREF="mailto:dantheox@aol.com">e-mail me</A>!)<BR><BR><B>The Effect Sequence</B></P><P>&#160;&#160;This is probably the most important part of this project.This partof the code will create an effect sequence that meets our precise needs. It'll bea simple fade between pic1 and pic2 that's 45 frames long. Here's the code:</P><P><TT>t=new QTEffectSequence(GetQTCrossFadeEffect, Pic1, Pic2</TT>,<TT> 45)</TT></P><P>That code makes use of a new &quot;constructor&quot; system in RB that lets youuse parameters in a line where you make an object using the new command. This iscommon in C and Java, and will probably be common in RB too.</P><P><B>Adding the frames</B></P><P>&#160;&#160;Now, we'll need to add frames to the movie (or, more accurately, thevideo track). Since we've already made the Effect sequence, we just need to go throughall 45 frames, and copy them from the sequence to the video track. Here's the code:</P><P><TT>For I=1 to 45<BR>&#160;&#160;t.Frame=I<BR>&#160;&#160;v.AppendPicture t.Image<BR>Next</TT></P><P>&#160;&#160;Simple enough. Now, let's display the movie:</P><P><TT>MoviePlayer1.Movie=m</TT><BR><BR><B>Wrapping Up</B></P><P>&#160;&#160;For those of you who like to see the code as a whole, here's a screenshot,just for you:</P><P><IMG SRC="moviecode.gif" WIDTH="473" HEIGHT="358" ALIGN="BOTTOM" BORDER="0"></P><P><B>Testing</B></P><P>&#160;&#160;Now, to test the program! For the grand test, I'll use these two images–thecalculator from System 1.0, and the calculator from Mac OS 8.</P><P><IMG SRC="OldCalc.gif" WIDTH="108" HEIGHT="171" ALIGN="BOTTOM" BORDER="0">&#160;&#160;<IMGSRC="NewCalc.GIF" WIDTH="109" HEIGHT="168" ALIGN="BOTTOM" BORDER="0"></P><P>&#160;&#160;Run the program, and load the two images. Then, click the Make Moviebutton. If all goes well, then you should see a &quot;select compression&quot; dialog.The defaults will work fine. After you hit OK in the compression dialog, you'll haveyour lovely transition!</P><P><B>Problems</B></P><P>&#160;&#160;As with many new features, the movie features have some problems.Here they are, and some workarounds for them:</P><P>&#160;&#160;1) The Play button doesn't play the movie in the MoviePlayer control.You can view it by holding down the Fast Forward button, however.</P><P>&#160;&#160;2) Be sure to quit your program before trying to open the movie filein another program. If you don't, you'll get a &quot;This file is not a movie&quot;error. Also, oddly enough, the Play button will work fine if you view the movie inApple's MoviePlayer program.</P><P><B>In Conclusion</B></P><P>&#160;&#160;That's how you make a movie! RB and QuickTime's transition capabilitiesmake simple movie-making fairly simple. Just add frames, and generate effects. Ifthe movie features in RB improve, and allow you to use sound, and access more effects(there are a lot of 'em, including the ever-popular flaming and explosion transitions...),RB will be a serious contender for making movies. Hooray!</P><P><B>Extra Stuff</B></P><P>&#160;&#160;If you've been especially moved by this article, you may want to trydoing these things:</P><UL>	<LI>Use the GetSMPTEEffect method, instead of GetQTCrossFadeEffect to use some effects	other than crossfades. (See <A HREF="smpte.html">this list</A> for details...)	<LI>Instead of usinga  simple transition, make it fade to the image, and then back	again. (Hint: make another QTEffectSequence).	<LI>Make a fade between more than two images.	<LI>Allow the user to control the number of frames, and type of transition between	each picture. If you get this working with multiple images, you've got a super-mini	Adobe Premiere app! Wow!</UL></BODY></HTML>