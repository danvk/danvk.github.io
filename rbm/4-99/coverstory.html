<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN"><HTML><HEAD>	<META HTTP-EQUIV="Content-Type" CONTENT="text/html;CHARSET=iso-8859-1">	<TITLE>Cover Story - Databases</TITLE>	<BASE target="_parent"></HEAD><BODY BGCOLOR="#FFFFFF"><P><FONT SIZE="5"><B>Databases and REALbasic Part 1</B></FONT><BR><FONT SIZE="4"><B>By Chris Daley</B></FONT><BR><FONT SIZE="4">Covers REALbasic 1.1 and DR2 releases</FONT></P><P><FONT SIZE="4"><B>Contents</B><BR></FONT><A HREF="#Introduction"><FONT SIZE="4">Introduction</FONT></A><FONT SIZE="4"><BR></FONT><A HREF="#Database"><FONT SIZE="4">Database concepts<BR></FONT></A><A HREF="#The"><FONT SIZE="4">The REALbasic database control</FONT></A><FONTSIZE="4"><BR></FONT><A HREF="#Other"><FONT SIZE="4">Other Database Options<BR></FONT></A><A HREF="#Links"><FONT SIZE="4">Links</FONT></A><A HREF="#Other"><FONTSIZE="4"></FONT></A></P><P><A NAME="Introduction"></A><FONT SIZE="4"><B>Introduction</B></FONT><BR>&#160;&#160;At the time of writing this article, there is no native support for Databaseaccess within REALbasic 1.1, although it has one of the features being developedin the Developer releases. Until that time though, those of use who require Databasesupport will have to rely on third party solutions, some good, some bad and somejust plain ugly! One of the key strengths of REALbasic is its open architecture whichallows you to extend the runtime capabilities substantially through the use of nativeplugins (written specifically for RB), Custom classes exported from RB, XCMD/XFCN(Hypercard external commands and functions), AppleScripts and Shared Libraries. Youcan also use AppleEvents to communicate with external database applications.</P><P><A NAME="Database"></A><FONT SIZE="4"><B>Database concepts</B></FONT><BR>&#160;&#160;When using databases in your applications, it is essential that you understandsome of the fundamental concepts of database design. If you are an experienced databasedeveloper, you may want to skip ahead to the sections on using databases within RB.Otherwise, read on…<BR>The main types of databases that we will be discussing are called Relational andflat-file databases.<BR>DataBase Management System (DBMS)</P><P><B>DBMS</B><BR>&#160;&#160;A DataBase Management System (DBMS) is the runtime engine used for managinga Database in an operational environment. When you interact with a database eitherprogrammatically or through a provided GUI, you are using that database's DBMS todo so. Examples of DBMS which are ODBC (programmed), FileMaker Pro (GUI) and 4D (GUIand programmed).</P><P><B>Tables</B><BR>&#160;&#160;Tables are the definition of a grouping and arrangement of data. A tableis like a spreadsheet in that it has columns (called fields) and rows (called records).In a relational database system, a table is defined for each unique entity that youwish to capture data for, i.e. you would have a separate table for customers andproducts and a third called sales which would be related to both of them. Flat filedatabases typically describe only one table per file and use lookups to relate toother flat-file databases.</P><P><B>Fields</B><BR>&#160;&#160;Fields are the columns of the database table and are required for a tableto be defined. Fields can be defined to store a variety of data types, includingnumbers, strings and even pictures or other binary data. Each field describes a uniquemember of a record (see below). In the customers table, for example, you would havefields for the customers name, title, address and so forth. Most DBMS require youto specify additional information about the fields, including maximum length anddata type.</P><P><B>Records</B><BR>&#160;&#160;Each row of the table is called a record. Records are a collection offields bound in a table which describe a unique entity, such as a customer or product.It is accepted practice that no two records in a database should be identical. SomeDBMS allow you to specify the value of a field to be unique, so as to prevent thisfrom occurring. Under these circumstances, the DBMS will throw an error, which youshould plan ahead to catch to prevent unhandled exception errors.</P><P><B>Indexes</B><BR>&#160;&#160;To speed up database routines, such as searching, most DBMS use indexes.Indexes are sorted lists wherein each item refers to a record in the table. If afield is indexed, it is always sorted and therefore the DBMS can execute queriesfaster by searching the index first. Indexes are always a good idea when using largedatabases as the speed difference can be noticeable.</P><P><B>Queries/SQL</B><BR>&#160;&#160;A query is a request to the DBMS to perform an operation on the database.Despite what the name may infer, queries are not necessarily searches, as they canalso be used to insert or remove data, perform relational lookups or even define/modifythe structure of a database table. In order to make queries simple and easy to use,a standardised natural english-like language has been developed by the ANSI committee,called, imaginatively enough, Structured Query Language (SQL). An SQL query containsall the information that the DBMS requires to return the requested search. An exampleSQL query on our customers table would look like this:</P><P><TT>Select name, address from customers where name is 'Fred'</TT></P><P>&#160;&#160;This query would instruct the DBMS to return the names and addressesfrom the customers table where the customers name is Fred. If there are no recordsfound, the DBMS will return an error code or null value. You should check for thisbefore attempting to use data from the query or your code will throw an nilObjectexceptionerror. SQL is fairly straight-forward and not that difficult to learn (unless youdon't speak english), if you've made it this far with REALbasic than SQL should bea doddle. A great tutorial on SQL can be found at ## so I strongly recommend youcheck it out before attempting to grapple with the REALbasic database control, asit uses SQL (but not exclusively). Once you have learnt SQL, you will find it extremelyuseful for generating queries across different DBMS.</P><P><A NAME="The"></A><FONT SIZE="4"><B>The REALbasic Database Control</B></FONT><BR>&#160;&#160;&#160;Accessing databases in REALbasic require the use of a number ofobjects/classes, specifically:</P><P>Database class<BR>DatabaseRecord class<BR>DatabaseCursor class<BR>DatabaseCursorField class<BR>DatabaseQuery control (optional)</P><P><B>Adding/Connecting to a database</B><BR>&#160;&#160;There are two ways you can manipulate a database in REALbasic, eitherby adding a database to the project through the IDE or connect to it programmatically.Both methods achieve the same result and allow the same level of manipulation ofthe data, but their differences are important to note. Adding a database to the projectmakes manipulating and viewing it's contents and structure easy and in a sense, allowsthe IDE to act as an interface to the DBMS of the chosen database. If you are designingan application around a database it is an excellent way to keep the project organizedand well documented internally. If you do not wish to allow the user to connect toor change the database, it is ideal. If you do want a more flexible way to connectto databases, you can do so programmatically, which is especially important if youare going to use a database plugin or allowing the user to specify a database oreven database format.</P><P>&#160;&#160;To add a database in the <IMG SRC="makedb.GIF" WIDTH="330" HEIGHT="136"ALIGN="RIGHT" BORDER="0">IDE, simply select the type of database you wish to usefrom the file&gt;add data source menu. You will notice that there is a new REALDatabaseoption in this sub-menu as well. We'll go through the steps of creating your owndatabase later. For the purpose of this discussion, we'll use a very simple customersdatabase, named, imaginatively enough, customers.rdb.</P><P>&#160;&#160;Once you select the appropriate database type, the DBMS will presentit's standard selection dialogue. In the case of the customers database, you willsee a Standard File/Nav Services file selection dialogue. Select customers.rdb fromit's location with the sample project. A new database item item will now be addedto your project with the name of customers. If you double-click on it you will seea schema window which allows you to edit the format of the database. We will go intoediting and viewing the schema in the next section.</P><P>&#160;&#160;Note: Notice how the schema window shows you the available tablesfor the database.<BR>Once the database is added to the project, you can now use all of the available methodsof a database object, which will be described in detail later. The new database objectis available globally, just like any other project item. This method is the simplestan easiest method of adding a database to your project. The other types of DBMS havedifferent dialogues but the net result is still a database object in your projectwindow.</P><P>&#160;&#160;If you wish to connect to a database at runtime, you can connect tothem programmatically by assigning the results of the appropriate select/open functionfor the database type you wish to use to a previously declared varibale of type database.In the case of the example database, you would use the openREALDatabase functionlike so:</P><P><TT>Dim testdat as database<BR>Dim dbspec as folderitem</TT></P><P><TT>dbspec = getfolderitem(&quot;customers.rdb&quot;)</TT></P><P><TT>if dbspec &lt;&gt; nil then<BR>&#160;&#160;testdat = openREALDatabase(dbspec)<BR>else<BR>&#160;&#160;MsgBox &quot;Database not found!&quot;<BR>&#160;&#160;// Error handler routine if file is not found<BR>end if</TT></P><P>&#160;&#160;You are now able to manipulate the customer database through the testdatvariable. To access databases of different DBMS, such as Oracle or dtf/SQL, use theappropriate function (see the database reference at the end of this article). Forexample:</P><P><TT>Testdat = OpenDTFDatabase(dbspec, dbspecBLOB, &quot;Bobe&quot;, &quot;CheesyPoofs&quot;)</TT></P><P>&#160;&#160;Would open a dtf/SQL database in the above example instead. You willneed to consult the documentation for each DBMS to access format specific features,but the database class gives you easy access to generic features and allows you towrite portable and DBMS agnostic code.</P><P>&#160;&#160;Okay, so now you have a database object either by adding it throughthe IDE or accessing it programmatically. What do you do with it now? To an extent,that depends on what it is you want to do with it, but before you can do anythingwith it, you need to know how the data is arranged in the database so you can searchand view the appropriate fields from the proper table. To do this, you need to analyzethe databases schema.</P><P><B>Viewing the schema</B><BR><IMG SRC="dataschema.gif" WIDTH="227" HEIGHT="177" ALIGN="RIGHT" BORDER="0">&#160;&#160;Ifyou are the author of the database, you already know how it is constructed, but ifyou aren't you will need to know how it is arranged so you can structure your searchand display code properly. Luckily, REALbasic provides two ways to view this information,once again, either through the IDE or through code.</P><P>&#160;&#160;To view the schema of the database in the IDE, simply double-clickon the database object in the project window. The Schema window will appear listingthe currently defined tables in the database, You will have three buttons on theright side: Open, Design and New. Open and Design are only available when you havea table selected.</P><P>&#160;&#160;Selecting Open will display a window showing the data in the table.This has some weirdness in the present implementation.</P><P>&#160;&#160;Selecting Design or Add will open the Edit Schema dialogue which allowsyou to add, modify and delete fields in the selected table or add and define a newone. We will go into the process of designing a database table later. The Edit Schemadialogue has an editfield containing the name of the table, which you can modify(be aware of DBMS specific naming conventions) or add a new one if starting fromscratch. The listbox in the middle contains a list of fields in the selected databaseand the top three buttons on the right allow you to Add, Edit or Delete field definitions.Cancel and Ok work as you would expect.</P><P><IMG SRC="tableadder.GIF" WIDTH="325" HEIGHT="169" ALIGN="LEFT" BORDER="0">&#160;&#160;Whenselect Add, Edit or double-click on a field name in the listbox, you are presentedwith the edit field dialogue which you can create new fields or rename existing ones.You will see that a field must be of a certain type. The REALDatabase field typesare smallint, integer and varchar but different DBMS have different field types.Don't worry too much about types at the moment, as we will deal with it later. Thereare also two checkboxes, Primary Key and Not Null. Primary key, when checked, indicatesthat the field is the primary index of the table, which you will remember helps speedup database routines. Not null when selected means that the field must contain datafor it to be part of a valid record. If you attempt to generate a record withoutincluding a value for such a field, the DBMS will generate an error.</P><P>&#160;&#160;As with connecting to a database, you can also view the schema ofa database programmatically. To do this, you need to declare a variable of DatabaseCursorclass and populate it with the relevant schema, either for a table or for the fieldsof a table. The relevant methods/properties of the DatabaseCursor class are listedlater. The DatabaseCursor class is at the heart of the very flexible database classhierarchy that REALbasic uses. The DatabaseCursor class is like a binarystream inthat it is a pointer to a record in a database (or query result) which can be incrementedand iterated through using simple and DBMS agnostic methods.</P><P><B>Viewing the Table Schema of a database</B></P><P><TT>Dim dcurs as DatabaseCursor</TT></P><P><TT>dcurs = datab.TableSchema</TT></P><P><TT>while not dcurs.eof<BR>&#160;&#160;listbox1.addrow dcurs.IdxField(1).nativeValue<BR>&#160;&#160;dcurs.moveNext<BR>wend</TT></P><P>&#160;&#160;In this example, we initialize a DatabaseCursor using the Databaseclass' TableSchema method. The cursor returned contains information about the tableschema of the database, for example the name of the tables. Particular points tonote are:<UL>	<LI>The DatabaseCurosr is traversed within a loop by checking the EOF (end-of-file)	and BOF (beginning-of-file) properties	<LI>The data is always contained in the 1st (1) IdxField array element	<LI>You must call the moveNext method to advance to the next record in the cursor</UL><P>&#160;&#160;The TableSchema method only returns information on the tables withinthe database. To view information about an individual Table's field struture, youuse the FieldSchema method of the database class.</P><P><B>Viewing the Field Schema of a database table</B></P><P><TT>Dim dcurs as DatabaseCursor</TT></P><P><TT>dcurs = datab.FieldSchema(&quot;Employees&quot;)</TT></P><P><TT>while not dcurs.eof<BR>&#160;&#160;listbox1.addrow dcurs.IdxField(1).nativeValue<BR>&#160;&#160;dcurs.moveNext<BR>wend</TT></P><P>&#160;&#160;As you can see, this will list all of the fields in the Employeesschema (lastname, firstname, and phone in the table screenshot above).</P><P><B>Querying the database</B><BR>&#160;&#160;The purpose of using a database in your project is to display and modifylarge amounts of data in a timely and ordered fashion. To retrieve this data, youwill need to query the database, which is, as the title suggests, asking the databasenicely for the information you want. The method that you use to query your chosendatabase depends on the individual DBMS, but by far the most popular method is bySQL. The REALDatabase format supports a limited but growing subset of the ANSI SQLspecification. SQL isn't as difficult to use as it first seems. The full ANSI SQLspecification is still a very small range of keywords and it is a fairly logicallanguage. The following are some SQL strings you may use to query the customers database.</P><P>&quot;Select * from customers&quot;<BR>&quot;Select phone, lastname from customers where firstname = 'bob'&quot;<BR>&quot;Delete * from customers where firstname = 'John'&quot;</P><P>&#160;&#160;The key to the flexibility of SQL is that it is passed to the DBMSas a string variable and can therefore be built by the programmer or end-user onthe fly. An example of this is:</P><P><TT>dCurs = Database.SQLSelect(&quot;Select &quot; + ListBox1.Text + &quot; from&quot; + dBTable + &quot; where &quot; + ListBox2.Text + &quot; = '&quot; + Editfield1.Text+ &quot;'&quot;)</TT></P><P>&#160;&#160;This line of code builds an SQL query string from user input (theListBoxes and Editfield) and global string variables (dBTable). The resulting querycould look like:</P><P>Select Name from Customers where Name = 'Bob'</P><P>&#160;&#160;Or</P><P>Select Name from Customers where Company = 'Bobe Inc'</P><P>&#160;&#160;Based on the results of the end-users selections. This allows youto do some funky stuff like building queries based on the results of queries andso on. SQL isn't perfect and it does have some shortcomings, but implemented as itis, it is an extremely flexible tool that should meet 99% of most database designersrequirements. As such, it is a little too large a topic to go into within this article,but there are several great sites on the web containing all you could want to knowabout. Advanced SQL will also be one of the topics in Part II: Advanced DatabaseDevelopment.<BR>The REALDatabase DBMS supports the following SQL syntax, but be aware that this isexpanding.</P><P><TT>create table &lt;tableName&gt;(&lt;column&gt; &lt;type&gt; [not null] [, &lt;column&gt;&lt;type&gt; [not null] primary key (&lt;column&gt; [, &lt;column&gt;]) )</TT></P><P>&#160;&#160;The create statement allows you create a new table and populate itwith fields of a specified type. We'll go into this SQL statement later when we discussdesigning databases.</P><P><TT>delete from &lt;tableName&gt; [where &lt;constraint&gt;]</TT></P><P>&#160;&#160;This statement deletes records that match the comparison in constraint.Be careful when using statements like delete as there are no undo statements in SQL!Visual Basic users will note that there is, as yet, no commit or rollback style commandsin the REALDatabase DBMS, so a Delete statement irreversibly removes the data.</P><P><TT>select &lt;column&gt; [,&lt;column&gt;] from &lt;tableName&gt; [where &lt;constraint&gt;]</TT></P><P>&#160;&#160;The select statement is used to search the database for records whichmatch the comparisons in constraint. The select statement is very powerful in theANSI specification, allowing you to join tables and group the results. For now, theREALDatabase DBMS is a little bit lighter, but expect this to change as it gets closerto release quality. You can still use the more powerful clauses with other DBMS,such as dtf/SQL which has complete ANSI SQL support and more (check the documentationfor the relevant DBMS you wish to use).</P><P><TT>update &lt;tableName&gt; set &lt;column&gt; = &lt;value&gt; [where &lt;constraint&gt;]</TT></P><P>&#160;&#160;The update statement updates the value of a selection of fields basedon the comparison in constraint. Using the update statement allows you to updateexisting records in a database</P><P>&lt;constraint&gt; is limited to &lt;columnName&gt; and the relational operators:<BR>&lt;= &#160;&#160;&#160;Less than or equal to<BR>&lt; &#160;&#160;&#160;&#160;Less than<BR>=&#160;&#160;&#160;&#160; Equals<BR>&gt;&#160;&#160;&#160;&#160; Greater than<BR>&gt;=&#160;&#160;&#160; Greater than or equal to<BR>&lt;&gt; &#160;&#160;&#160;Less than or greater than (not equal)<BR>also 'and' and 'or' is supported</P><P>&#160;&#160;Other DBMS use keywords such as 'Like' and 'Slike' for more flexiblecomparisons. Slike, for instance, performs a 'Sounds-Like' comparison on a stringvariable. Some DBMS also allow the use or Regular Expressions to make your searcheseven more powerful and flexible. Once again, you will need to check the DBMS' docs.</P><P>&#160;&#160;Once you have constructed your query string, you need to send it tothe DBMS. This can be done either by the two REALbasic database class methods, SQLSelect()and SQLExecute() or through the DatabaseQuery control. We will go into the DatabaseQuerycontrol in more detail later, but for now, be aware of its SQLQuery property whichcan be either modified in the IDE through the properties window or during runtimethrough a simple assignment statement:</P><P><TT>DatabaseQuery1.SQLQuery = &quot;Select * from customers&quot;</TT></P><P><IMG SRC="dbquery.gif" WIDTH="87" HEIGHT="95" ALIGN="RIGHT" BORDER="0">&#160;&#160;Thetwo database class methods both submit a query to the database but only one, SQLSelect,returns a DatabaseCursor to be interrogated. Which do you use? Well, the SQLSelectmethod is for when you when you want to display or modify the results of a query,usually with a select statement, as the method name implies. To use the SQLSelectmethod, simply create an instance of a database and declare a databasecursor variableto store its result. Using our Customers database, the code would look like this:</P><P><TT>Dim dbase as database<BR>Dim dbasecursor as databasecursor</TT></P><P><TT>dbase = GetREALDatabase(GetFolderItem(&quot;Customers.rdb&quot;))<BR>dbasecurosr = dbase.SQLSeclect(&quot;Select * from Customers&quot;)</TT></P><P>&#160;&#160;We could then iterate through the databasecursor to view the resultsof our query. We'll go into this in more depth shortly.</P><P>&#160;&#160;The SQLExecute method is for when you wish to submit a query thatyou does not return a recordset, such as a delete or update statement. An SQLExecuteon the above database would look like this:</P><P><TT>Dim dbase as database</TT></P><P><TT>dbase = GetREALDatabase(GetFolderItem(&quot;Customers.rdb&quot;))<BR>dbase.SQLExecute(&quot;Delete from Customers where name &lt;&gt; 'Bob'&quot;)</TT></P><P>&#160;&#160;This would delete all the records from the customers database wherethe name isn't Bob.</P><P>&#160;&#160;The REALbasic database is more or less DBMS agnostic, meaning it behavesthe same regardless of which DBMS you are using, with the exception of a few specificcommands. This make your code highly portable across different database types, reducingthe amount of coding and debugging you have to do. For example, the above code samplescould be used for a dtf/SQL database simply by substituting the first assignment,i.e.</P><P><TT>Dbase = SelectDTFDatabase(Getfolderitem(&quot;customers.dtf&quot;)</TT>, <TT>GetFolderitem(&quot;customers.bit&quot;),&quot;dtfadm&quot;,&quot;dtfadm&quot;)</TT></P><P>&#160;&#160;The preceeding code would still work providing both customers databasehave the same field and table structure. This combined with SQL, a string based querylanguage which can be built on the fly from user input, makes the REALbasic databaseimplementation highly portable and very flexible. It is quite easy to program a databaseapplication which has no prior knowledge of the database design it will be requiredto handle.</P><P>&#160;&#160;A database query using the SQLSelect function returns a DatabaseCursorwhich you can then iterate though to display the results of your query. We are alreadyfamiliar with displaying the information contained a DatabaseCursor from our previousschema related queries. Extracting data from a cursor returned by a query is nota great deal more difficult, although it has a charm all it's own.</P><P>&#160;&#160;Advanced users who have experience with MS Visual Basic will notethat the REALbasic DatabaseCursor appears to be unidirectional, although it has nomethods for moving backwards yet, it does have a BOF property, which suggests thepossibility of a reverse iteration method.<BR>It is important to check the results of your query before you attempt to use it.A standard &lt;&gt; nil test, as you have seen in the previous code examples, willstop your application from crashing but does not really provide any way of debuggingwhat is going wrong with you query. If you do not test for the success of your queryand use a DatabaseCursor that has not been initialized, the runtime engine will throwa NilObjectExceptionError. You can catch this with an error handler or avoid it altogetheras mentioned above. The majority of errors you will encounter will be the resultof an incorrectly formatted query. To avoid this, you should do the following whendeveloping and debugging:<UL>	<LI>Build the SQL query as a local string variable before passing it. This way you	can set a breakpoint before it is used and check its validity.	<LI>Make sure that any required information to build the query string is present	before submitting the it. If the query is built from user input, check to see it	is complete, and prompt the user for any missing data.	<LI>Bear in mind that the DatabaseCursor will return nil if there are no records	that match the query, so always test your queries on a known data set.	<LI>Points to remember with SQL:	<LI>Field and table names are included in the query with no quotes of any kind i.e.	&quot;Select ThisIsAFieldName from ThisIsATableName&quot;	<LI>String comparisons and string data are included with single quote marks i.e.	&quot;Select ThisIsAFieldName from ThisIsATableName where ThisIsAFieldName = 'This	is a text comparison'&quot;	<LI>Integer comparisons and data are included in the query with no quotes of any	kind i.e. &quot;Select ThisIsANumericField from ThisIsATableName where ThisIsANumericField	= 1&quot;	<LI>Date and currency values require special formatting characters when used as comparisons	or data.	<LI>Once we have our DatabaseCursor containing the records that result from our query,	how do we display them? Luckily, that's the topic of the next section!</UL><P><B>Displaying the data</B><BR>Ok, if you've stuck with it this far, you should have a fully loaded DatabaseCursor,and the will to use it! A DatabaseCursor object or class allows you to iterate througha set of records returned by a query. You have already used a DatabaseCursor to extractinformation about the database's schema, so you shouldn't find this too difficult.</P><P><B>Manipulating the data<BR>Creating you own database</B><BR>Check your DBMS naming conventions for table and field names and make sure that yourdesign complies with it.</P><P><B>The DatabaseQuery control<BR>Database reference</B></P><P><B>Database class</B><BR>- SQLSelect(selectString As String) As DatabaseCursor<BR>- SQLExecute(executeString As String)</P><P>* New functions<BR>- OpenDTFDatabase(dbFile As FolderItem, blobFile As FolderItem, username As String,password As String) As Database<BR>(For dtF/SQL databases)<BR>- SelectODBCDatabase As Database<BR>(For ODBC databases)<BR>- OpenPostgreSQLDatabase(host as string, port as integer, database as string, useras string, password as string) As Database<BR>- OpenOracleDatabase(username as string, password as string) as Database</P><P>* New function (in 4dpluginPPC)<BR>- Select4DDatabaseByADSP(task as string, username as string, password as string)As Database</P><P>- FieldSchema(tableName As String) As DatabaseCursor<BR>Implemented for RB database and dtf/SQL<BR>- TableSchema As DatabaseCursor<BR>returns a cursor will a list of all of the tables in the database - implemented forRB database, PostgreSQL, dtf/SQL</P><P>- InsertRecord(table as string, data as DatabaseRecord)</P><P><B>DatabaseCursor class</B><BR><B>Methods</B><BR>- BOF As Boolean (Read only - Beginning of File)<BR>- EOF As Boolean (Read only - End of File)<BR>- FieldCount As Integer (Read only - number of fields in cursor)<BR>- MoveNext (Move to next record in cursor)<BR>- Field(Name As String) As DatabaseCursorField<BR>- IdxField(Index As Integer) As DatabaseCursorField<BR>- DeleteRecord<BR>currently only implemented for RB database<BR>- Edit<BR>- Update<BR>- First call Edit, then change fields, then call Update</P><P><B>DatabaseCursorField class</B><BR>- Name As String (Read only - name of field)<BR>- StringValue As String (Read/write)<BR>- NativeValue As String (Read/write)<BR>- getString As String<BR>- setString(newValue As String)<BR>[getString/setString methods are equivalent to getting/setting StringValue property]<BR>- DatabaseCursorField implements StringProvider interface</P><P><B>DatabaseQuery control</B><BR>- Database As Database<BR>- SQLQuery As String<BR>- RunQuery<BR>- can be bound to a listbox</P><P><B>DatabaseRecord class</B><BR>• Column(name as string) As String (read/write)<BR>• FieldCount As Integer<BR>• getIndString(fieldIndex as integer) As String</P><P><B>REALDatabase class</B><BR>First implementation of internal database engine<BR>- newREALDatabase(spec As FolderItem) As Database<BR>- openREALDatabase(spec As FolderItem) As Database<BR>- only supports very limited SQL dialect so far:<BR>- create table &lt;tableName&gt;(&lt;column&gt; &lt;type&gt; [not null] [, &lt;column&gt;&lt;type&gt; [not null] primary key (&lt;column&gt; [, &lt;column&gt;]) )<BR>- delete from &lt;tableName&gt; [where &lt;constraint&gt;]<BR>- select &lt;column&gt; [,&lt;column&gt;] from &lt;tableName&gt; [where &lt;constraint&gt;]<BR>- update<BR>- &lt;constraint&gt; is limited to &lt;columnName&gt; &lt;= | &lt; | = | &gt; | &gt;=| &lt;&gt; value, also 'and' and 'or' is supported</P><P><A NAME="Other"></A><FONT SIZE="4"><B>Other Database Options</B></FONT><BR>&#160;&#160;Presently, the database controls and classes are only available in theDeveloper releases of REALbasic. For some people developing commercial software,this may not be a viable solution, as these releases are no where near stable enough.The only alternative when using REALbasic 1.1 then is to use a third-party solution.These options run the gamut of simple to brain-frying, depending on the type of DBMSyou wish to access.</P><P>&#160;&#160;So as a budding database programmer, where do you start? The tablebelow lists all the current thrid-party options, what form they are in and how toget them...<UL>	<LI>DtfSQL	<LI>Jovis	<LI>mSQL	<LI>simple database	<LI>FileFlex	<LI>ODBC	<LI>AppleEvents/AppleScripts</UL><P><B>DtfSQL</B><BR>&#160;&#160;DtfSQL, developed and released by the german SLAB group is an SQL basedDatabase Management System (DBMS). It is fully featured with both client and serverversions and is available in a variety of formats and platforms.</P><P>&#160;&#160;Of most interest to 1.1 users are the XCMD and Shared Library versions,available, of course, in 68K and PowerPC versions. There is an excellent demo ofthe client shared library version by Alex Kushner, available at the caf&#233;. Ingeneral the shared library will be faster than the XCMD although with Dtf this isbarely noticeable as it is very fast. The relative merits of shared libraries andexternals are discussed later on. Both are small and fast and incur little systemoverheads.</P><P>&#160;&#160;The DR2 releases have a native driver for DtfSQL databases. Usingthis driver is the same as using the other built-in drivers.(See below).</P><P>&#160;&#160;Dtf is available as a full-featured demo that you can use to developyour applications, but you must license it if you intend to distribute it. Theirlicensing fees are quite reasonable and the most up-to date prices can be found ontheir web site.</P><P>&#160;&#160;Dtf uses ANSI Structured Query Language (SQL) to extract data fromthe databases. SQL is an easy to learn syntax with an awful lot of documentationabout it available on-line. Links to a number of suitable sites for finding out moreabout SQL are included at the end of this article. It goes without saying that SQLis too large a topic to discuss here, but it is relatively simple to learn and use,as well as being portable across DBMS. Dtf is well suited to developing everythingfrom stand-alone single-database applications to full-blown information client-serversystems.<BR>Dtf uses its own datasource format which isn’t compatible with any other databasetypes. Its supports all data types including BLOB (Binary Large OBject). The documentationis quite concise and available in English and German.</P><P><B>Jovis</B><BR>&#160;&#160;The Jovis database engine is developed by DASworks and is available inthe form of a collection of externals (XCMDs/XFCNs) which have recently been re-writtenfor REALbasic. The Jovis database engine uses its own proprietary datasource formatand query language. The downloadable demo includes a sample REALbasic project showingyou how to use its methods and functions and is well commented and shows off someof the systems features quite well.</P><P>&#160;&#160;You must license Jovis if you intend to distribute it, but their licensefees are reasonable. It would seem that DASworks is committed to developing Jovisfor REAL basic and their web site is quite helpful. Jovis is well suited to developingstand alone database applications.</P><P><B>mSQL</B><BR>&#160;&#160;I have only included this one because it is a topic close to my heartand a solution that I’m sure a number of RB users will appreciate. MiniSQL is a Unix-baseddatabase server developed by Hughes technology. While the DBMS is hosted on a Unixserver, it is accessible by TCP/IP. I came across it while developing a web sitewhich used mSQL and found it very useful. The form I used it in was a shared librarycompiled for the Mac and available here.</P><P>&#160;&#160;mSQL uses the ANSI SQL standard with a few of its own enhancements.A server module for Unix web servers called mslq-lite allows you to manipulate anmSQL database through a scripting language horribly enough based on C. Until developinga mac based solution, database structure manipulation had to be done through eitherTelnet or complex web scripting. The shared library makes this a breeze by beingable to develop my own interface at the speed RB is famous for.<BR>The mSQL shared library is commercial software from Hughes Technology and availablefrom http://www.hughes.com.au. You need to be running the mSQL server in order forthe mSQL shared library to be of any use to you though. Special commendations tothe author for his efforts in porting the shared library to the Mac.</P><P><B>Simple Database<BR></B>&#160;&#160;Simple database is a set of externals allowing basic manipulationof a proprietary format datasource and query language. Originally developed for Hypercard,I haven’t yet been able to get a working version of the simple database with RB.The Hypercard demo looks pretty good, and it's fast, but it caused a number of buserrors on my PowerTower.<BR>Check out license etc...</P><P><B>FileFlex</B><BR>&#160;&#160;Developed as an external for Hyper/Supercard and Xtra for Director, theFileFlex uses its own proprietary datasource and query language. Toted as the Multi-mediadatabase solution, I found it a little disappointing to the point of not actuallygetting it to work. I don’t know whether this was a problem with the XCMD interfaceas I kept getting bus errors and freezes.</P><P>&#160;&#160;FileFlex comes in demo form and requires you to license it beforedistributing it with your application. The site and download package has ample documentationand the hypercard demo works splendidly and several of my Director using friendsswear by it. If I can get a working RB demo, I will post it my FTP site forthwith.</P><P><B>ODBC</B><BR>&#160;&#160;ODBC (Open DataBase Connectivity) is not presently directly supportedby REALbasic 1.1 but is available in the Dr releases. The distinct advantage ODBCoffers is the ability to use such a large number of industry standard data formats,such as FoxPro and dBase. The down-side is the enormous installations package (severalMbs) additional system extensions (and obligatory conflicts) and requires complexconfiguration - not for the faint hearted. ODBC uses SQL as its query language.</P><P><B>AppleEvents/AppleScript</B><BR>&#160;&#160;While not a database system in themselves, you can use AppleEvents orAppleScripts to communicate with and manipulate almost any Mac OS based databasesystem. Probably the best developed and compatible system for this would be FileMakerPro which supports a wide range of Apple Events and is highly scriptable. A big downsideis needing to have a licensed copy of the database system installed and running onthe client machine at the same time as your application. While this system wouldbe inappropriate for a distributed application, it would be an ideal solution fora FileMaker add-on package or web server. Examples of controlling databases suchas FileMaker Pro via AppleScript/events are at their web site.</P><P><B>A bit about XCMDs Vs Shared Libraries</B><BR>&#160;&#160;XCMDs/XFCNs are plugins developed for HyperCard/SuperCard which can alsobe used by REALbasic to extend its runtime functionality. XCMD is short for ExternalCommand and XFCN are External Functions. Both are compiled into the resource forkof your application and their code executed at runtime.</P><P>&#160;&#160;Shared Libraries are ‘code fragments’ or small components of executablecode which can be called by an application to do a specific task. Also called DynamicallyLinked Libraries, Shared Libraries are a fundamental component of the PowerPC andCFM-68K operating systems. Accessed through ‘entry points’ and memoryblocks, sharedlibraries are complex to use but allow access to some of the core MacOS toolbox calls.Shared libraries can presently only be used on Power PCs,. XCMDs and XFCNs will workon either PowerPC or 68K systems. If you want to squeeze every last bit of optimisationout, be sure to use the xcmd as opposed to XCMD, as they are PowerPC native. XCMDs/XFCNsby and large have a much easier to use interface than shared libraries and don’trequire detailed knowledge of entry points, pointers and other complex abstracts.As far as which one to use, it’s really a matter of personal programming preferenceand the needs of the particular project.</P><P><FONT SIZE="4"><B>Links:</B></FONT><BR><A HREF="http://www.macdb.com/">www.macdb.com</A> – Database links, using AppleScriptwith ODBC<BR><A HREF="http://www.geocities.com/ResearchTriangle/Node/9672/sqltut.html">SQL Tutorial</A>– An excellent introduction to SQL.<BR><A HREF="http://torresoft.netmegs.com/">Interactive SQL Tutorial</A> – Another introductionto SQL.</BODY></HTML>