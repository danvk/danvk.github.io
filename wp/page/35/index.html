 
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">


<!-- Mirrored from www.danvk.org/wp/page/35/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 15 Oct 2014 03:37:21 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="generator" content="WordPress 3.9.2" /> <!-- leave this for stats please -->
	<title>danvk.org</title>
	<style type="text/css" media="screen">
		@import url( ../../wp-content/themes/ocadia/style.css);
			</style>
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="../../feed/index.html" />
	<link rel="alternate" type="text/xml" title="RSS .92" href="../../feed/rss/index.html" />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="../../feed/atom/index.html" />
	<link rel="pingback" href="../../xmlrpc.php" />
    	<link rel='archives' title='October 2014' href='../../2014/10/index.html' />
	<link rel='archives' title='August 2014' href='../../2014/08/index.html' />
	<link rel='archives' title='July 2014' href='../../2014/07/index.html' />
	<link rel='archives' title='June 2014' href='../../2014/06/index.html' />
	<link rel='archives' title='March 2014' href='../../2014/03/index.html' />
	<link rel='archives' title='February 2014' href='../../2014/02/index.html' />
	<link rel='archives' title='January 2014' href='../../2014/01/index.html' />
	<link rel='archives' title='August 2013' href='../../2013/08/index.html' />
	<link rel='archives' title='June 2013' href='../../2013/06/index.html' />
	<link rel='archives' title='April 2013' href='../../2013/04/index.html' />
	<link rel='archives' title='March 2013' href='../../2013/03/index.html' />
	<link rel='archives' title='February 2013' href='../../2013/02/index.html' />
	<link rel='archives' title='January 2013' href='../../2013/01/index.html' />
	<link rel='archives' title='December 2012' href='../../2012/12/index.html' />
	<link rel='archives' title='September 2012' href='../../2012/09/index.html' />
	<link rel='archives' title='August 2012' href='../../2012/08/index.html' />
	<link rel='archives' title='July 2012' href='../../2012/07/index.html' />
	<link rel='archives' title='June 2012' href='../../2012/06/index.html' />
	<link rel='archives' title='May 2012' href='../../2012/05/index.html' />
	<link rel='archives' title='April 2012' href='../../2012/04/index.html' />
	<link rel='archives' title='February 2012' href='../../2012/02/index.html' />
	<link rel='archives' title='January 2012' href='../../2012/01/index.html' />
	<link rel='archives' title='December 2011' href='../../2011/12/index.html' />
	<link rel='archives' title='November 2011' href='../../2011/11/index.html' />
	<link rel='archives' title='August 2011' href='../../2011/08/index.html' />
	<link rel='archives' title='March 2011' href='../../2011/03/index.html' />
	<link rel='archives' title='June 2010' href='../../2010/06/index.html' />
	<link rel='archives' title='March 2010' href='../../2010/03/index.html' />
	<link rel='archives' title='December 2009' href='../../2009/12/index.html' />
	<link rel='archives' title='November 2009' href='../../2009/11/index.html' />
	<link rel='archives' title='October 2009' href='../../2009/10/index.html' />
	<link rel='archives' title='September 2009' href='../../2009/09/index.html' />
	<link rel='archives' title='August 2009' href='../../2009/08/index.html' />
	<link rel='archives' title='June 2009' href='../../2009/06/index.html' />
	<link rel='archives' title='May 2009' href='../../2009/05/index.html' />
	<link rel='archives' title='March 2009' href='../../2009/03/index.html' />
	<link rel='archives' title='February 2009' href='../../2009/02/index.html' />
	<link rel='archives' title='January 2009' href='../../2009/01/index.html' />
	<link rel='archives' title='December 2008' href='../../2008/12/index.html' />
	<link rel='archives' title='November 2008' href='../../2008/11/index.html' />
	<link rel='archives' title='October 2008' href='../../2008/10/index.html' />
	<link rel='archives' title='September 2008' href='../../2008/09/index.html' />
	<link rel='archives' title='August 2008' href='../../2008/08/index.html' />
	<link rel='archives' title='June 2008' href='../../2008/06/index.html' />
	<link rel='archives' title='May 2008' href='../../2008/05/index.html' />
	<link rel='archives' title='February 2008' href='../../2008/02/index.html' />
	<link rel='archives' title='January 2008' href='../../2008/01/index.html' />
	<link rel='archives' title='December 2007' href='../../2007/12/index.html' />
	<link rel='archives' title='November 2007' href='../../2007/11/index.html' />
	<link rel='archives' title='October 2007' href='../../2007/10/index.html' />
	<link rel='archives' title='September 2007' href='../../2007/09/index.html' />
	<link rel='archives' title='August 2007' href='../../2007/08/index.html' />
	<link rel='archives' title='July 2007' href='../../2007/07/index.html' />
	<link rel='archives' title='June 2007' href='../../2007/06/index.html' />
	<link rel='archives' title='May 2007' href='../../2007/05/index.html' />
	<link rel='archives' title='April 2007' href='../../2007/04/index.html' />
	<link rel='archives' title='March 2007' href='../../2007/03/index.html' />
	<link rel='archives' title='February 2007' href='../../2007/02/index.html' />
	<link rel='archives' title='January 2007' href='../../2007/01/index.html' />
	<link rel='archives' title='December 2006' href='../../2006/12/index.html' />
	<link rel='archives' title='November 2006' href='../../2006/11/index.html' />
	<link rel='archives' title='October 2006' href='../../2006/10/index.html' />
	<link rel='archives' title='September 2006' href='../../2006/09/index.html' />
	<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.9.2" />
<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>
</head>
	
<body>

<div id="wrapper">

<div id="header">
<h1><a href="http://www.danvk.org/wp">danvk.org</a></h1>
<p>Keepin&#8217; static like wool fabric since 2006</p>
</div>

<div id="content">

			
				
		<div class="post">

			<h1 class="storydate">02.11.07</h1> 
			<h2 id="post-90" class="storytitle"><a href="../../2007-02-11/comments-should-be-working-again/index.html" rel="bookmark" title="Permanent link to Comments should be working again">Comments should be working again</a></h2>
			<p class="meta">Posted in <a href="../../category/meta/index.html" title="View all posts in meta" rel="category tag">meta</a> at 5:48 pm by danvk</p>
		
							<p>Turns out my <a href="../../indexe9b4.html?p=58">Comment CAPTCHA</a> wasn&#8217;t so smart after all. It stopped comment spam by stopping all comments. I&#8217;ve switched over to <a href="http://akismet.com/">Akismet</a>, so hopefully the comments should be working again.</p>
			
			<p class="feedback">
			<a href="../../2007-02-11/comments-should-be-working-again/index.html" rel="bookmark" title="Permanent link to Comments should be working again" class="permalink">Permalink</a>
			<span class="commentslink">Comments off</span>						</p>
			
			<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.danvk.org/wp/2007-02-11/comments-should-be-working-again/"
    dc:identifier="http://www.danvk.org/wp/2007-02-11/comments-should-be-working-again/"
    dc:title="Comments should be working again"
    trackback:ping="http://www.danvk.org/wp/2007-02-11/comments-should-be-working-again/trackback/" />
</rdf:RDF>			-->

			</div>
	
				
		<div class="post">

			<h1 class="storydate">02.10.07</h1> 
			<h2 id="post-89" class="storytitle"><a href="../../2007-02-10/one-last-boggle-boost/index.html" rel="bookmark" title="Permanent link to One Last Boggle Boost">One Last Boggle Boost</a></h2>
			<p class="meta">Posted in <a href="../../category/boggle/index.html" title="View all posts in boggle" rel="category tag">boggle</a>, <a href="../../category/programming/index.html" title="View all posts in programming" rel="category tag">programming</a> at 10:24 pm by danvk</p>
		
							<p><a href="../../index5d38.html?p=87">Last time</a>, we used Tries to get a 20x speedup of an already-fast Boggle program. This time, we&#8217;ll ferret out the largest remaining bottleneck to produce an even faster Boggler.</p>
<p>What are the main operations that we perform in solving a Boggle board? There&#8217;s 1) word lookup, 2) checking if we&#8217;ve previously found a word, 3) checking if a letter starts a word and 4) recursion. Here&#8217;s how much time they take:</p>
<table>
<tr>
<th>Operation</th>
<th>Complexity</th>
</tr>
<tr>
<td>Word Lookup</td>
<td>Memory access (<code>Trie::CompletesWord</code>)</td>
</tr>
<tr>
<td>Previously found?</td>
<td>Hash lookup/insertion</td>
</tr>
<tr>
<td>Starts a word?</td>
<td>Memory access (<code>Trie::StartsWord</code>)</td>
</tr>
<tr>
<td>Recursion</td>
<td>Subroutine call</td>
</tr>
</table>
<p>We&#8217;re not going to do better than a memory access or a subroutine call. But who knows how long a hash lookup/insert takes? It&#8217;s <i>O(1)</i>, but who knows what that constant factor is? It&#8217;s certainly more time than a memory access. Let&#8217;s see if we can replace that hash lookup/insert with another memory access. We&#8217;ll go through a couple of ideas.</p>
<p><b>Trie annotation</b><br />
The Trie reduces <code>CompletesWord</code> and <code>StartsWord</code> to memory lookups by storing their results in each node (the <code>is_word</code> and <code>children</code> properties). So why not add another boolean property, <code>found</code>, to each Trie node.</p>
<p>This will clearly reduce the check for whether we&#8217;ve found a word to a memory access. The problem is that, if we&#8217;ve found a word on one board, we haven&#8217;t necessarily found it on the next. So when we&#8217;re done solving a board, we need to go back and clean up the Trie. That requires another data structure to track which Trie nodes we&#8217;ve marked and an extra loop to reset their <code>found</code> property after every board. That&#8217;s at least four memory accesses, not just one.</p>
<p>What&#8217;s more, this approach destroys the thread safety of the Trie. Since the Boggler can write to the Trie as well as read it, multiple solvers could easily mess each other up.</p>
<p>This approach works fairly well in practice, but it&#8217;s more complex than it seems at first.</p>
<p><b>Bit Vector</b><br />
This is inspired by the thread safety argument against Trie annotation. Instead of storing the found bit in the Trie, why not store it somewhere else? Each thread will have a store, so thread safety isn&#8217;t an issue. This approach isn&#8217;t so different than the hash table approach we used last time, except that it uses a bit vector so it&#8217;s faster but uses more memory.</p>
<p>This approach has <i>many</i> drawbacks. First of all, how do you map pointer addresses to locations in a bit vector? There&#8217;s a lot of places that a pointer can point to, and there needs to be a bit in the bit vector for all of them. In practice, we&#8217;d measure the extent of the Trie in memory and adjust for memory alignment and the number of bits in a word. Unfortunately, you still wind up with a bit vector that&#8217;s not that much smaller than the Trie itself.</p>
<p>The bit vector has the same clearing problem after the board has been solved. Using <code>bzero</code> to clear the whole vector every time has a dramatic effect on perf, so you wind up using an extra array to track which bits you&#8217;ve set, just like the annotation strategy. This is way more complex than the first idea, but it is thread-safe.</p>
<p><b>Annotation revisited</b><br />
This approach took me forever to come up with, but I think it&#8217;s the best.</p>
<p>Instead of annotating the Trie with a boolean <code>found</code> value, we can annotate it with a full 32-bit integer. The Boggler keeps track of how many boards it&#8217;s solved and stores that value in the Trie node of each word it finds. When it finds a word again, it compares the <code>found</code> value in that node against the board number. If they&#8217;re the same, that word has been found <i>on this board</i>. Otherwise it hasn&#8217;t. The beauty of this approach is that we don&#8217;t need to clean up after ourselves. It&#8217;s fine to leave a mess in the Trie, because that mess will never equal the next board number.</p>
<p>We&#8217;ll have to do a complete sweep of the Trie to clean out the board numbers when we overflow the board counter, but that happens only once every 2^32 = 4 billion boards, so it&#8217;s not a serious concern.</p>
<p>This approach is the simplest, since we don&#8217;t need any auxiliary data structures. It&#8217;s also the fastest, since we don&#8217;t have to clean up after ourselves. But it&#8217;s not thread-safe, which is its only major drawback.</p>
<p><b>The code</b><br />
Here&#8217;s the new stuff in trie.h:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
inline void Mark(unsigned mark) { mark_ = mark; }
inline unsigned Mark() const { return mark_; }
unsigned mark_;
</pre>
<p>We need to add a variable to count the number of boards we&#8217;ve processed in boggler.h:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
unsigned num_boards_;
</pre>
<p>And here&#8217;s the goodies from boggler.cc:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
void ClearMarks(Trie* t) {             // NEW
	t-&gt;Mark(0);                        // NEW
	for (int i=0; i&lt;kNumLetters; i++)  // NEW
		if (t-&gt;StartsWord(i))          // NEW
			ClearMarks(t-&gt;Descend(i)); // NEW
}
// Returns the score from this portion of the search
void Boggler::Solve(int x, int y, int len, Trie* t) {
	prev_[x][y] = true;

	len += (bd_[x][y]=='q'-'a' ? 2 : 1);
	if (t-&gt;IsWord()) {
		if (t-&gt;Mark() != num_boards_) { // NEW
			score_ += kWordScores[len]; // NEW
			t-&gt;Mark(num_boards_);       // NEW
		}
	}

	for (int dx=-1; dx&lt;=1; ++dx) {
		int cx = x + dx;
		if (cx&lt;0 || cx&gt;3) continue;
		for (int dy=-1; dy&lt;=1; ++dy) {
			int cy = y + dy;
			if (cy&lt;0 || cy&gt;3) continue;
			if (prev_[cx][cy]) continue;
			if (t-&gt;StartsWord(bd_[cx][cy]))
				Solve(cx, cy, len, t-&gt;Descend(bd_[cx][cy]));
		}
	}
	
	prev_[x][y] = false;
}
int Boggler::Score(const char* letters) {
	if (!ParseBoard(letters)) return -1;

	score_ = 0;
	for (int i=0; i&lt;16; ++i)
		Solve(i/4, i%4, 0, dict_-&gt;Descend(bd_[i/4][i%4]));

	num_boards_++;         // NEW
	if (!num_boards_) {    // NEW
		ClearMarks(dict_); // NEW
		num_boards_ = 1;   // NEW
	}
	return score_;
}
</pre>
<p>That&#8217;s about a 15 line change total. What does it buy us?</p>
<pre>$ <b>./perf</b>
Loaded 172203 words.
Testing perf on 50000 boards...
50000 boards in 4.82284 secs => 10367.35 bds/sec
Average board score: 141.1734 pts/bd
</pre>
<p>That&#8217;s another 65% speedup from last time. It&#8217;s certainly not 20x, but impressive nonetheless.</p>
<p>Now that we&#8217;ve got a lightning-fast Boggle solver we can solving interesting problems with it. Until next time, <a href="../../wp-content/uploads/2007/boggle6/index.html">here&#8217;s the source</a>.</p>
<p>To recap, here&#8217;s how far we&#8217;ve come:</p>
<table cellspacing=3>
<tr>
<th>Program</th>
<th>Speed</th>
<th>Change</th>
<th>Improvement</th>
</tr>
<tr>
<td><a href="../../index7665.html?p=65">Original</a></td>
<td>.004 b/s</td>
<td>-</td>
<td>Really simple Ruby</td>
</tr>
<tr>
<td><a href="../../index4f61.html?p=66">Stems</a></td>
<td>17.5 b/s</td>
<td>4000x</td>
<td>Used stems to prune the DFS</td>
</tr>
<tr>
<td><a href="../../index6213.html?p=86">C++</a></td>
<td>310 b/s</td>
<td>18x</td>
<td>Converted Ruby to C++</td>
</tr>
<tr>
<td><a href="../../index5d38.html?p=87">Tries</td>
<td>6271 b/s</td>
<td>20x</td>
<td>Use Tries instead of hashes</td>
</tr>
<tr>
<td>Final</td>
<td>10367 b/s</td>
<td>65%</td>
<td>Annotate the Trie with board counter</td>
</tr>
</table>
<p>That&#8217;s a factor of six million improvement since our first try. It&#8217;s interesting to note that the final 600x of improvements all came from replacing <i>O(1)</i> operations with other <i>O(1)</i> operations.</p>
			
			<p class="feedback">
			<a href="../../2007-02-10/one-last-boggle-boost/index.html" rel="bookmark" title="Permanent link to One Last Boggle Boost" class="permalink">Permalink</a>
			<a href="../../2007-02-10/one-last-boggle-boost/index.html#comments" class="commentslink"  title="Comment on One Last Boggle Boost">4 Comments</a>						</p>
			
			<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.danvk.org/wp/2007-02-10/one-last-boggle-boost/"
    dc:identifier="http://www.danvk.org/wp/2007-02-10/one-last-boggle-boost/"
    dc:title="One Last Boggle Boost"
    trackback:ping="http://www.danvk.org/wp/2007-02-10/one-last-boggle-boost/trackback/" />
</rdf:RDF>			-->

			</div>
	
				
		<div class="post">

			<h1 class="storydate">02.06.07</h1> 
			<h2 id="post-87" class="storytitle"><a href="../../2007-02-06/in-which-we-discover-that-tries-are-awesome/index.html" rel="bookmark" title="Permanent link to In which we discover that Tries are awesome">In which we discover that Tries are awesome</a></h2>
			<p class="meta">Posted in <a href="../../category/boggle/index.html" title="View all posts in boggle" rel="category tag">boggle</a>, <a href="../../category/programming/index.html" title="View all posts in programming" rel="category tag">programming</a> at 2:29 am by danvk</p>
		
							<p><i>This is the sixth installment in an ongoing series about Boggle. See also <a href="../../index96f1.html?p=67">1</a>, <a href="../../index7665.html?p=65">2</a>, <a href="../../index4f61.html?p=66">3</a>, <a href="../../index55e4.html?p=83">4</a> and <a href="../../index6213.html?p=86">5</a>.</i></p>
<p>We&#8217;ve <a href="../../index55e4.html?p=83">talked before</a> about why <a href="http://en.wikipedia.org/wiki/Tries">Tries</a> are the perfect data structure for solving Boggle boards. Today we&#8217;ll adapt the <a href="../../wp-content/uploads/2007/boggle4/index.html">C++ program</a> from <a href="../../index6213.html?p=86">yesterday&#8217;s post</a> to use them.</p>
<p>Here&#8217;s a picture of part of a Trie:</p>
<p><center><img src='../../wp-content/uploads/2007/02/bubbles-lines.png' alt='bubbles-lines.png' height="167" width="180" /></center></p>
<p>There are three important operations that we can perform quickly on a Trie node:</p>
<ol>
<li>Check whether the current node completes a word</li>
<li>Check whether a particular character leads to more words</li>
<li>Descend to a child node</li>
</ol>
<p>So, in addition to some convenience functions, our Trie interface will need to support these operations. Here&#8217;s what I came up with:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
const int kNumLetters = 26;

class Trie {
  public:
	Trie();
	virtual ~Trie();
	
	// FAST access functions
	inline bool IsWord() { return is_word_; }
	inline bool StartsWord(int i) { return children_[i]; }
	inline Trie* Descend(int i) { return children_[i]; }
	
	// Slower utility functions
	void AddWord(const char* wd);
	int LoadFile(const char* filename);
	bool IsWord(const char* wd) const; // Look up a full word
	unsigned int size() const;         // Total # of words
	
  private:
	Trie* children_[kNumLetters];
	bool is_word_;
};
</pre>
<p>As you can see, the big three operations are all fast inline accessors. There&#8217;s one nuance worth talking about here: why do <code>StartsWord</code> and <code>Descend</code> take integers? In pictures of Tries, the edges are usually labeled with strings, or at least characters. This is partially a performance optimization: by mapping &#8216;a&#8217;..&#8217;z&#8217; to 0..25, the program can avoid lots of annoying additions and subtractions. It also forces us to treat the &#8216;qu&#8217; die specially. From now on, we&#8217;ll consider the letter &#8216;q&#8217; to stand in for &#8220;qu&#8221;. We&#8217;ll have to be careful to filter words containing a &#8216;q&#8217; not followed by a &#8216;u&#8217; from the dictionary to make this work. We&#8217;ll also change our input interface to reflect this. Since each cell can be represented with exactly one character, there&#8217;s no reason to separate them with spaces anymore. Where we used to write &#8220;a b c d e f g h i j k l m n o p&#8221;, we&#8217;ll write &#8220;abcdefghijklmnop&#8221;. This greatly simplifies the board parsing code. I won&#8217;t go into any details, but the implementation can be found in <a href="../../wp-content/uploads/2007/boggle5/trie.cc">trie.cc</a>.</p>
<p>Now for the Boggler class. We&#8217;ll try to avoid changing the public interface. The only change will be the format of the boards, from &#8220;a b c &#8230;&#8221; to &#8220;abc&#8230;&#8221; The Boggler will need a Trie to contain its dictionary, but this allows us to remove the <code>words_</code> and <code>stems_</code> hashes. Finally, we&#8217;ll need some way to remember which words we&#8217;ve found. A hash will do fine here, but there&#8217;s some trickiness which we&#8217;ll get to below:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
#include &lt;ext/hash_set&gt;
#include &lt;inttypes.h&gt;      // for uintptr_t
using namespace __gnu_cxx; // for hash_set
class Trie;

class Boggler {
  public:
	Boggler();
    int LoadDictionary(const char* filename);
	int Score(const char* bd);
	
  private:
	bool ParseBoard(const char* lets);
	void Solve(int x, int y, int len, Trie* t);
	
	hash_set&lt;uintptr_t&gt; found_;
	int bd_[4][4];
 	bool prev_[4][4];
	int score_;
	Trie* dict_;
};
</pre>
<p>So, what the hell is a <code>uintptr_t</code>? We&#8217;ll get to that in a sec. What&#8217;s more interesting is that the type signature of the recursive <code>Solve</code> method has changed. We no longer know what letters are in the word we&#8217;ve found so far, only its length. This is all we need to know for scoring, but it&#8217;s a little disconcerting. If we don&#8217;t know the characters in the word we&#8217;ve found, how can we tell whether we&#8217;ve found it before?</p>
<p>The solution is in the Trie. There&#8217;s a one-to-one correspondence between nodes in the Trie and words in the dictionary. If we&#8217;ve found a word before, then we&#8217;ve necessarily been to this Trie node before. So instead of storing the whole word in a hash, we can just store a pointer to the Trie node in its place. This is exactly the kind of dirty hack that I mentioned last time. You can do this in C/C++, but Ruby makes it rather difficult.</p>
<p>That leads us to <code>uintptr_t</code>. The STL won&#8217;t just let us put any old pointer into a <code>hash_set</code>. We need to convert it to something that the STL knows how to hash. On a 32-bit system, we could just use an unsigned int or long. But that <a href="http://www.unix.org/whitepapers/64bit.html">won&#8217;t always work</a>. The <code>uintptr_t</code> data type is an unsigned long that&#8217;s guaranteed to have the same number of bits as a pointer. So there we go.</p>
<p>Maybe a picture will clarify things. This shows the Boggle board on the left with all four arguments to the <code>Solve</code> function at each node. On the right is a part of the Trie, annotated with memory addresses. This may have also been an excuse to play with Photoshop..</p>
<p><a href='../../wp-content/uploads/2007/02/triegraph.png' title='triegraph.png'><img src='../../wp-content/uploads/2007/02/triegraph.png' alt='triegraph.png' /></a></p>
<p>Here&#8217;s the juicy bits of the implementation:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
// Returns the score from this portion of the search
void Boggler::Solve(int x, int y, int len, Trie* t) {
	prev_[x][y] = true;

	len += (bd_[x][y]=='q'-'a' ? 2 : 1);
	if (t-&gt;IsWord()) {
		// Convert the Trie node to an int and look it up
		uintptr_t hash = reinterpret_cast&lt;uintptr_t&gt;(t);
		if (found_.find(hash) == found_.end()) {
			score_ += kWordScores[len];
			found_.insert(hash);
		}
	}

	// Recur in each possible direction
	for (int dx=-1; dx&lt;=1; ++dx) {
		int cx = x + dx;
		if (cx&lt;0 || cx&gt;3) continue;
		for (int dy=-1; dy&lt;=1; ++dy) {
			int cy = y + dy;
			if (cy&lt;0 || cy&gt;3) continue;
			if (prev_[cx][cy]) continue;
			if (t-&gt;StartsWord(bd_[cx][cy]))
				Solve(cx, cy, len, t-&gt;Descend(bd_[cx][cy]));
		}
	}
	
	prev_[x][y] = false;
}

int Boggler::Score(const char* letters) {
	if (!ParseBoard(letters)) return -1;

	score_ = 0;
	for (int i=0; i&lt;16; ++i)
		Solve(i/4, i%4, 0, dict_-&gt;Descend(bd_[i/4][i%4]));
	found_.clear();
	return score_;
}

// Board format: &quot;bcdefghijklmnopq&quot;
bool Boggler::ParseBoard(const char* lets) {
	for (int i=0; i&lt;16; i++) {
		if (!lets[i] || lets[i]&lt;'a' || lets[i]&gt;'z')
		  return false;
		bd_[i/4][i%4] = lets[i] - 'a';
	}
	return true;
}
</pre>
<p>Now the moment of truth&#8230; what kind of performance do we get out of this? I wrapped a small binary called <code>perf</code> that we&#8217;ll be using to measure this from now on. It solves 50,000 pre-defined boards and reports on the time used:</p>
<pre>
$ <b>./perf</b>
Loaded 172203 words.
Testing perf on 50000 boards...
50000 boards in 7.97206 secs => 6271.91 bds/sec
Average board score: 141.1734 pts/bd
</pre>
<p>That&#8217;s another 20x improvement over the previous post&#8217;s Boggler class!</p>
<p>Fast as this board is, there&#8217;s still one major, unnecessary bottleneck left in it. Any guesses? We&#8217;ll fix it tomorrow, at which point we&#8217;ll have a Boggler that&#8217;s about as fast as I know how to make it. Then we can start doing the fun stuff with it.</p>
<p>Complete source code for today&#8217;s Boggler can be found <a href="../../wp-content/uploads/2007/boggle5/index.html">here</a>.</p>
			
			<p class="feedback">
			<a href="../../2007-02-06/in-which-we-discover-that-tries-are-awesome/index.html" rel="bookmark" title="Permanent link to In which we discover that Tries are awesome" class="permalink">Permalink</a>
			<span class="commentslink">Comments off</span>						</p>
			
			<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.danvk.org/wp/2007-02-06/in-which-we-discover-that-tries-are-awesome/"
    dc:identifier="http://www.danvk.org/wp/2007-02-06/in-which-we-discover-that-tries-are-awesome/"
    dc:title="In which we discover that Tries are awesome"
    trackback:ping="http://www.danvk.org/wp/2007-02-06/in-which-we-discover-that-tries-are-awesome/trackback/" />
</rdf:RDF>			-->

			</div>
	
				
		<div class="post">

			<h1 class="storydate">02.04.07</h1> 
			<h2 id="post-86" class="storytitle"><a href="../../2007-02-04/moving-boggle-to-c/index.html" rel="bookmark" title="Permanent link to Moving Boggle to C++">Moving Boggle to C++</a></h2>
			<p class="meta">Posted in <a href="../../category/boggle/index.html" title="View all posts in boggle" rel="category tag">boggle</a>, <a href="../../category/programming/index.html" title="View all posts in programming" rel="category tag">programming</a> at 11:55 pm by danvk</p>
		
							<p><a href="../../index55e4.html?p=83">Last time</a>, we talked about <a href="http://en.wikipedia.org/wiki/Trie">Tries</a>, the perfect data structure for Boggle. To take full advantage of Tries, we need to move to a lower-level language than Ruby, which leads to today&#8217;s task: convert our Ruby code to C++.</p>
<p><a href="http://www.cookcomputing.com/blog/archives/000084.html">Premature optimization</a> is the root of all evil, so our main goal here is to get a working C++ Boggle solver. We&#8217;ll use STL <a href="http://www.msoe.edu/eecs/ce/courseinfo/stl/string.htm">strings</a> and <a href="http://www.sgi.com/tech/stl/hash_set.html">hash tables</a> to produce code that&#8217;s as close to the last Ruby program as possible. That being said, I&#8217;m going to take this opportunity to extract the Boggle-solving code into its own class. Here&#8217;s the interface I came up with:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
#include &lt;ext/hash_set&gt;
#include &lt;string&gt;
using namespace __gnu_cxx; // for hash_set
using namespace std;       // for string

class Boggler {
 public:
  Boggler();
  int LoadDictionary(const char* filename);
  int Score(const char* letters);
  	
 private:
  bool ParseBoard(const char* lets);
  void Solve(int x, int y, const string&amp; sofar);
  
  hash_set&lt;string&gt; words_;
  hash_set&lt;string&gt; stems_;
  hash_set&lt;string&gt; found_;
  string bd_[4][4];
  bool prev_[4][4];
  int score_;
};
</pre>
<p>The routines mostly do what their names imply. <code>LoadDictionary</code> populates the <code>words_</code> and <code>stems_</code> hashes based on a word list. <code>ParseBoard</code> takes input like &#8220;a b c d e f g h i j k l m n o p&#8221; and populates the <code>bd_</code> array. <code>Score</code> parses and scores a board, while <code>Solve</code> is its recursive workhorse.</p>
<p>Before getting to the implementation of this interface, let&#8217;s look at a few programs that use it. Here&#8217;s one that tests some boards with known scores (try the <a href="boggle.html">online boggle solver</a> to test them):</p>
<pre class="brush: cpp; title: ; notranslate" title="">
#include &quot;boggler.h&quot;

#include &lt;string&gt;
#include &lt;iostream&gt;
using namespace std;

int main(int argc, char** argv) {
	Boggler b;
	int words = b.LoadDictionary(&quot;words&quot;);
	cout &lt;&lt; &quot;Loaded &quot; &lt;&lt; words &lt;&lt; &quot; words.&quot; &lt;&lt; endl;
	cout &lt;&lt; &quot;b.Score(abcd...) =&gt; &quot; &lt;&lt; b.Score(&quot;a b c d e f g h i j k l m n o p&quot;) &lt;&lt; &quot; == 18?&quot; &lt;&lt; endl;
	cout &lt;&lt; &quot;b.Score(qu...) =&gt; &quot; &lt;&lt; b.Score(&quot;t c e e v w h b t s t u qu a a e&quot;) &lt;&lt; &quot; == 94?&quot; &lt;&lt; endl;
	cout &lt;&lt; &quot;b.Score(catd...) =&gt; &quot; &lt;&lt; b.Score(&quot;c a t d l i n e m a r o p e t s&quot;) &lt;&lt; &quot; == 2338?&quot; &lt;&lt; endl;
}
</pre>
<p>This program is just a quick sanity check. If the Boggler correctly scores those three boards, then it&#8217;s doing a whole lot right. Here&#8217;s another program that reads boards from standard input and scores each of them. We can use it to test correctness and measure performance:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
#include &lt;iostream&gt;
using namespace std;

#include &quot;boggler.h&quot;

int main(int argc, char** argv) {
	Boggler b;
	b.LoadDictionary(&quot;words&quot;);

	char linebuf[256];
	while (cin.getline(linebuf, 256)) {
		cout &lt;&lt; b.Score(linebuf) &lt;&lt; endl;
	}
}
</pre>
<p>Now for the implementation, <code>boggle.cc</code>. The interface requires four functions: <code>LoadDictionary</code>,  <code>ParseBoard</code>, <code>Score</code> and <code>Solve</code>. The last is the most interesting, and it can be translated directly from Ruby:</p>
<pre class="brush: ruby; title: ; notranslate" title="">
def solve(x, y, sofar)
  Prev[x][y]=true

  wd = sofar + Bd[x][y]
  Found[wd]=true if Words[wd]
  
  Dirs.each do |dx,dy|
    next unless (0..3)===(x+dx)
    next unless (0..3)===(y+dy)
    next if Prev[x+dx][y+dy]
    solve(x+dx,y+dy,wd) if Stems[wd]
  end
  
  Prev[x][y] = false
end
</pre>
<pre class="brush: cpp; title: ; notranslate" title="">
void Boggler::Solve(int x, int y, const string&amp; sofar) {
	prev_[x][y] = true;
	
	string wd = sofar + bd_[x][y];
	if (words_.find(wd) != words_.end()) {
		if (found_.find(wd) == found_.end()) {
			found_.insert(wd);
			score_ += kWordScores[wd.size()];
		}
	}
	
	for (int dx=-1; dx&lt;=1; ++dx) {
		int cx = x + dx;
		if (cx&lt;0 || cx&gt;3) continue;
		for (int dy=-1; dy&lt;=1; ++dy) {
			int cy = y + dy;
			if (cy&lt;0 || cy&gt;3) continue;
			if (prev_[cx][cy]) continue;
			if (stems_.find(wd) != stems_.end())
				Solve(cx, cy, wd);
		}
	}
	
	prev_[x][y] = false;
}
</pre>
<p>The STL syntax for looking up an element in a hash_set is hideous: <code>words_.find(wd) != words_.end()</code>? I can&#8217;t understand why there&#8217;s no equivalent of Ruby&#8217;s <code>has_key?</code> function. What else do you do with hashes? Here&#8217;s <code>Score</code>:</p>
<pre class="brush: cpp; title: ; notranslate" title="">
int Boggler::Score(const char* letters) {
	if (!ParseBoard(letters)) return -1;

	score_ = 0;
	for (int i=0; i&lt;16; ++i)
		Solve(i/4, i%4, &quot;&quot;);
	found_.clear();
	return score_;
}
</pre>
<p><!-- --></p>
<p>Simple enough. The other two functions require some STL-fu, but aren&#8217;t especially interesting. You can check out the complete source and Makefile from <a href="../../wp-content/uploads/2007/boggle4/index.html">here</a>.</p>
<p>First the sanity check:</p>
<pre>
$ <b>make</b>
g++  -g -Wall -O3 -march=i686  -c -o test.o test.cc
g++  -g -Wall -O3 -march=i686  -c -o boggler.o boggler.cc
g++   test.o boggler.o   -o test
g++  -g -Wall -O3 -march=i686  -c -o scorer.o scorer.cc
g++   scorer.o boggler.o   -o scorer
$ <b>./test</b>
Loaded 172233 words.
b.Score(abcd...) => 18 == 18?
b.Score(qu...) => 94 == 94?
b.Score(catd...) => 2338 == 2338?
</pre>
<p>So we&#8217;ve got correctness. Now the big question: how&#8217;s the performance? We&#8217;ll get a baseline by scoring zero boards with scorer and then feed it 5,000 boards from a list of 50,000 that I created:</p>
<pre>
$ <b>time echo '' | ./scorer</b>

-1

real    0m1.431s
user    0m1.294s
sys     0m0.052s
$ <b>time head -5000 test-boards | ./scorer > /dev/null</b>

real    0m17.525s
user    0m17.412s
sys     0m0.107s
$ <b>echo "5000/(17.412-1.294)" | bc -q</b>
310.212185134632088
</pre>
<p>That&#8217;s an 18x improvement over last time, exclusively from moving to C++. There is a <a href="http://shootout.alioth.debian.org/debian/benchmark.php?test=all&amp;lang=gpp&amp;lang2=ruby">Ruby penalty</a>, and 18x is a perfectly believable value for it. I suspect that, if Ruby had a VM, (as it <a href="http://wiki.rubygarden.org/Ruby/page/show/Rite">will soon</a> and <a href="http://jruby.codehaus.org/">kind of does</a> already) then this factor could be entirely eliminated. What can&#8217;t be eliminated is where we&#8217;ll go next. There are some times when it really is worth getting your hands dirty hacking around for performance tweaks. C++ makes those hacks possible, whereas Ruby does not. A simple example: rather than doing all the string addition in <code>Boggler::Solve</code>, we could use a pre-allocated character buffer. I could easily see this gaining a 2-3x performance improvement. But you can&#8217;t easily break the string abstraction in Ruby.</p>
<p>Next time we&#8217;ll add Tries to the C++ program. You can get the full source for today&#8217;s Boggle from <a href="../../wp-content/uploads/2007/boggle4/index.html">here</a>.</p>
			
			<p class="feedback">
			<a href="../../2007-02-04/moving-boggle-to-c/index.html" rel="bookmark" title="Permanent link to Moving Boggle to C++" class="permalink">Permalink</a>
			<a href="../../2007-02-04/moving-boggle-to-c/index.html#comments" class="commentslink"  title="Comment on Moving Boggle to C++">1 Comment</a>						</p>
			
			<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.danvk.org/wp/2007-02-04/moving-boggle-to-c/"
    dc:identifier="http://www.danvk.org/wp/2007-02-04/moving-boggle-to-c/"
    dc:title="Moving Boggle to C++"
    trackback:ping="http://www.danvk.org/wp/2007-02-04/moving-boggle-to-c/trackback/" />
</rdf:RDF>			-->

			</div>
	
				
		<div class="post">

			<h1 class="storydate">02.02.07</h1> 
			<h2 id="post-84" class="storytitle"><a href="../../2007-02-02/adium-10-is-out/index.html" rel="bookmark" title="Permanent link to Adium 1.0 is out!">Adium 1.0 is out!</a></h2>
			<p class="meta">Posted in <a href="../../category/uncategorized/index.html" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a> at 10:50 pm by danvk</p>
		
							<p>Go pick up your copy of <a href="http://www.adiumx.com/">Adium 1.0</a>, the new release of the greatest IM program ever. It&#8217;s Mac-only and it&#8217;s beautiful. I&#8217;ve been using it with only <a href="http://trac.adiumx.com/ticket/4">one complaint</a> for at least 4-5 years (yes, it&#8217;s been in beta that long). That one annoyance was non-functioning AIM file transfers, which they <a href="http://www.adiumx.com/changelogs/Adium_1.0_Changes.html">claim</a> to have fixed. We&#8217;ll see, they&#8217;ve claimed that before. Here&#8217;s what it looks like:</p>
<p><img src='../../wp-content/uploads/2007/02/adium.png' alt='adium.png' /></p>
<p>I&#8217;m using the &#8220;Concise&#8221; layout with the &#8220;Decay 2.0&#8243; color scheme. I enlarged the font from 9->10 pt, reduced the spacing to 3px, and added a 6px gutter on the left. I think it looks good, very compact and understated, but quite clear and useable.</p>
<p><b>Update:</b> Despite looking great, file transfer is still AWOL. Shoot.</p>
			
			<p class="feedback">
			<a href="../../2007-02-02/adium-10-is-out/index.html" rel="bookmark" title="Permanent link to Adium 1.0 is out!" class="permalink">Permalink</a>
			<a href="../../2007-02-02/adium-10-is-out/index.html#comments" class="commentslink"  title="Comment on Adium 1.0 is out!">1 Comment</a>						</p>
			
			<!--
			<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://www.danvk.org/wp/2007-02-02/adium-10-is-out/"
    dc:identifier="http://www.danvk.org/wp/2007-02-02/adium-10-is-out/"
    dc:title="Adium 1.0 is out!"
    trackback:ping="http://www.danvk.org/wp/2007-02-02/adium-10-is-out/trackback/" />
</rdf:RDF>			-->

			</div>
	
		
		<p>
			<span class="post_nav"><a href="../34/index.html" >&laquo; Previous Page</a> &#8212; <a href="../36/index.html" >&laquo; Previous entries</a></span>
		<!--	<a href="http://www.danvk.org/wp/page/34/" >&laquo; Previous Page</a> &#183; <a href="http://www.danvk.org/wp/page/36/" >Next Page &raquo;</a>-->
			<span><a href="../34/index.html" >Next entries &raquo;</a> &#8212; <a href="../36/index.html" >Next Page &raquo;</a></span>
		</p>
		
	
</div>

<div id="sidebar">
<ul>

	<li id="search">
		<form method="get" id="searchform" action="http://www.danvk.org/wp/index.php">
<p>
<input type="text" value="" name="s" id="s" /><br />
<input type="submit" id="searchsubmit" value="Search" />
</p>
</form>	</li> 

<!-- I want more control than this gives me: wp_list_pages('title_li=<h2>' . __('Pages') . '</h2>' ); -->

	<li class="pagenav">
		<ul>
			<!--<li class="page_item"><a href="http://www.danvk.org/wp/?page_id=2" title="About">About</a></li>-->
			<li>Dan across the web
				<ul>
					<li class="social">
					<a href="https://github.com/danvk"><img src="https://github.com/favicon.ico" width=16 height=16 border=0></a>
					<a href="https://twitter.com/danvdk"><img src="https://twitter.com/favicon.ico" width=16 height=16 border=0></a>
					<a href="https://www.facebook.com/danvdk"><img src="https://facebook.com/favicon.ico" width=16 height=16 border=0></a>
					<a href="https://plus.google.com/+DanVanderkam"><img src="https://plus.google.com/favicon.ico" width=16 height=16 border=0></a>
					<a href="https://www.linkedin.com/profile/view?id=340204755"><img src="https://www.linkedin.com/favicon.ico" width=16 height=16 border=0></a>
					<script data-gittip-username="danvdk" data-gittip-widget="button" src="http://gttp.co/v1.js"></script>
				</ul>

			<li>Dan's projects
				<ul class="projects">
					<li><a href="http://dygraphs.com/">dygraphs</a>
					<li><a href="http://oldsf.org/">OldSF</a>
					<li><a href="http://comparea.org/">Comparea</a>
					<li><a href="https://github.com/danvk/webdiff">git webdiff</a>
				</ul>

			<li>Features on this site
				<ul class="features">
					<li><a href="https://www.danvk.org/boggle/" title="Boggle Solver">Online Boggle Solver</a></li>
					<li><a href="../../beals-conjecture/index.html" title="Beal&#039;s Conjecture">Beal's Conjecture</a></li>
					<li><a href="../../gw-basic-program-decoder/index.html" title="GW-BASIC Program Decoder">GW-BASIC Program Decoder</a></li>
					<li><a href="http://www.danvk.org/tower/nstower.html">NS-Tower in your Browser</a></li>
				</ul>
		</ul>
	</li>

	<!--
	<li id="twitter_sidebar">
		<div id="twitter_div">
		<a href="http://twitter.com/danvdk" target="_blank"><h2 class="sidebar-title">Follow me on Twitter</h2></a>
		<ul id="twitter_update_list" style="padding-right:30px"></ul>
		
		</div>
		<script type="text/javascript" src="http://twitter.com/javascripts/blogger.js"></script>
		<script type="text/javascript" src="http://twitter.com/statuses/user_timeline/danvdk.json?callback=twitterCallback2&amp;count=5"></script>
	</li>
	-->

	<li id="archives">
		<h2>Archives</h2>
		<ul>
			<li><a href='../../2014/10/index.html'>October 2014</a></li>
	<li><a href='../../2014/08/index.html'>August 2014</a></li>
	<li><a href='../../2014/07/index.html'>July 2014</a></li>
	<li><a href='../../2014/06/index.html'>June 2014</a></li>
	<li><a href='../../2014/03/index.html'>March 2014</a></li>
	<li><a href='../../2014/02/index.html'>February 2014</a></li>
	<li><a href='../../2014/01/index.html'>January 2014</a></li>
	<li><a href='../../2013/08/index.html'>August 2013</a></li>
	<li><a href='../../2013/06/index.html'>June 2013</a></li>
	<li><a href='../../2013/04/index.html'>April 2013</a></li>
	<li><a href='../../2013/03/index.html'>March 2013</a></li>
	<li><a href='../../2013/02/index.html'>February 2013</a></li>
	<li><a href='../../2013/01/index.html'>January 2013</a></li>
	<li><a href='../../2012/12/index.html'>December 2012</a></li>
	<li><a href='../../2012/09/index.html'>September 2012</a></li>
	<li><a href='../../2012/08/index.html'>August 2012</a></li>
	<li><a href='../../2012/07/index.html'>July 2012</a></li>
	<li><a href='../../2012/06/index.html'>June 2012</a></li>
	<li><a href='../../2012/05/index.html'>May 2012</a></li>
	<li><a href='../../2012/04/index.html'>April 2012</a></li>
	<li><a href='../../2012/02/index.html'>February 2012</a></li>
	<li><a href='../../2012/01/index.html'>January 2012</a></li>
	<li><a href='../../2011/12/index.html'>December 2011</a></li>
	<li><a href='../../2011/11/index.html'>November 2011</a></li>
	<li><a href='../../2011/08/index.html'>August 2011</a></li>
	<li><a href='../../2011/03/index.html'>March 2011</a></li>
	<li><a href='../../2010/06/index.html'>June 2010</a></li>
	<li><a href='../../2010/03/index.html'>March 2010</a></li>
	<li><a href='../../2009/12/index.html'>December 2009</a></li>
	<li><a href='../../2009/11/index.html'>November 2009</a></li>
	<li><a href='../../2009/10/index.html'>October 2009</a></li>
	<li><a href='../../2009/09/index.html'>September 2009</a></li>
	<li><a href='../../2009/08/index.html'>August 2009</a></li>
	<li><a href='../../2009/06/index.html'>June 2009</a></li>
	<li><a href='../../2009/05/index.html'>May 2009</a></li>
	<li><a href='../../2009/03/index.html'>March 2009</a></li>
	<li><a href='../../2009/02/index.html'>February 2009</a></li>
	<li><a href='../../2009/01/index.html'>January 2009</a></li>
	<li><a href='../../2008/12/index.html'>December 2008</a></li>
	<li><a href='../../2008/11/index.html'>November 2008</a></li>
	<li><a href='../../2008/10/index.html'>October 2008</a></li>
	<li><a href='../../2008/09/index.html'>September 2008</a></li>
	<li><a href='../../2008/08/index.html'>August 2008</a></li>
	<li><a href='../../2008/06/index.html'>June 2008</a></li>
	<li><a href='../../2008/05/index.html'>May 2008</a></li>
	<li><a href='../../2008/02/index.html'>February 2008</a></li>
	<li><a href='../../2008/01/index.html'>January 2008</a></li>
	<li><a href='../../2007/12/index.html'>December 2007</a></li>
	<li><a href='../../2007/11/index.html'>November 2007</a></li>
	<li><a href='../../2007/10/index.html'>October 2007</a></li>
	<li><a href='../../2007/09/index.html'>September 2007</a></li>
	<li><a href='../../2007/08/index.html'>August 2007</a></li>
	<li><a href='../../2007/07/index.html'>July 2007</a></li>
	<li><a href='../../2007/06/index.html'>June 2007</a></li>
	<li><a href='../../2007/05/index.html'>May 2007</a></li>
	<li><a href='../../2007/04/index.html'>April 2007</a></li>
	<li><a href='../../2007/03/index.html'>March 2007</a></li>
	<li><a href='../../2007/02/index.html'>February 2007</a></li>
	<li><a href='../../2007/01/index.html'>January 2007</a></li>
	<li><a href='../../2006/12/index.html'>December 2006</a></li>
	<li><a href='../../2006/11/index.html'>November 2006</a></li>
	<li><a href='../../2006/10/index.html'>October 2006</a></li>
	<li><a href='../../2006/09/index.html'>September 2006</a></li>
		</ul>
	</li>

		
	<li id="categories">
		<h2>Categories</h2>
		<ul>
			<li class="cat-item cat-item-21"><a href="../../category/astronomy/index.html" title="View all posts filed under astronomy">astronomy</a>
</li>
	<li class="cat-item cat-item-10"><a href="../../category/boggle/index.html" title="View all posts filed under boggle">boggle</a>
</li>
	<li class="cat-item cat-item-8"><a href="../../category/books/index.html" title="View all posts filed under books">books</a>
</li>
	<li class="cat-item cat-item-23"><a href="../../category/finance/index.html" title="View all posts filed under finance">finance</a>
</li>
	<li class="cat-item cat-item-27"><a href="../../category/javascript/index.html" title="View all posts filed under javascript">javascript</a>
</li>
	<li class="cat-item cat-item-20"><a href="../../category/math/index.html" title="View all posts filed under math">math</a>
</li>
	<li class="cat-item cat-item-13"><a href="../../category/meta/index.html" title="View all posts filed under meta">meta</a>
</li>
	<li class="cat-item cat-item-19"><a href="../../category/movies/index.html" title="View all posts filed under movies">movies</a>
</li>
	<li class="cat-item cat-item-11"><a href="../../category/music/index.html" title="View all posts filed under music">music</a>
</li>
	<li class="cat-item cat-item-16"><a href="../../category/news/index.html" title="View all posts filed under news">news</a>
</li>
	<li class="cat-item cat-item-5"><a href="../../category/personal/index.html" title="View all posts filed under personal">personal</a>
</li>
	<li class="cat-item cat-item-6"><a href="../../category/politics/index.html" title="View all posts filed under politics">politics</a>
</li>
	<li class="cat-item cat-item-2"><a href="../../category/programming/index.html" title="View all posts filed under programming">programming</a>
</li>
	<li class="cat-item cat-item-9"><a href="../../category/reviews/index.html" title="View all posts filed under reviews">reviews</a>
</li>
	<li class="cat-item cat-item-22"><a href="../../category/san-francisco/index.html" title="View all posts filed under san francisco">san francisco</a>
</li>
	<li class="cat-item cat-item-7"><a href="../../category/science/index.html" title="View all posts filed under science">science</a>
</li>
	<li class="cat-item cat-item-28"><a href="../../category/space/index.html" title="View all posts filed under space">space</a>
</li>
	<li class="cat-item cat-item-17"><a href="../../category/sports/index.html" title="View all posts filed under sports">sports</a>
</li>
	<li class="cat-item cat-item-3"><a href="../../category/tennis/index.html" title="View all posts filed under tennis">tennis</a>
</li>
	<li class="cat-item cat-item-4"><a href="../../category/travel/index.html" title="View all posts filed under travel">travel</a>
</li>
	<li class="cat-item cat-item-18"><a href="../../category/tv/index.html" title="View all posts filed under tv">tv</a>
</li>
	<li class="cat-item cat-item-1"><a href="../../category/uncategorized/index.html" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
	<li class="cat-item cat-item-15"><a href="../../category/web/index.html" title="View all posts filed under web">web</a>
</li>
	<li class="cat-item cat-item-14"><a href="../../category/wikipedia/index.html" title="View all posts filed under wikipedia">wikipedia</a>
</li>
 
		</ul>
	</li>
	
			
	  <li id="linkcat-12" class="linkcat"><h2>Blogroll</h2>
	<ul>
<li><a href="http://aldaily.com/" title="Put on your academ hat">A&amp;L Daily</a></li>
<li><a href="http://www.badastronomy.com/bablog/" title="More astronomy stuff">Bad Astronomy</a></li>
<li><a href="http://trikyguy.wordpress.com/" rel="acquaintance met" title="Fratrik&#8217;s blog">Beware of Roaming</a></li>
<li><a href="http://www.centauri-dreams.org/" title="More astronomy stuff">Centauri Dreams</a></li>
<li><a href="http://cosmicvariance.com/" title="Astronomy stuff">Cosmic Variance</a></li>
<li><a href="http://blog.dreamhost.com/">DreamHost Blog</a></li>
<li><a href="http://www.electoral-vote.com/" title="Daily projections of the mid-term elections">Electoral Vote</a></li>
<li><a href="http://scienceblogs.com/goodmath/" title="A mathematician takes on the innumerate">Good Math, Bad Math</a></li>
<li><a href="http://www.mattcutts.com/blog/" title="A googleguy">Matt Cutts</a></li>
<li><a href="http://www.google.com/reader/shared/14715583592159254943" title="Feel free to subscribe to my shared items on Google Reader">My Shared Items (Google Reader)</a></li>
<li><a href="http://scienceblogs.com/pharyngula/" title="Evolution! A bit much at times&#8230;">Pharyngula</a></li>
<li><a href="http://reddit.com/" title="My fave site">Reddit</a></li>
<li><a href="http://thedailywtf.com/" title="For all the software engineers">The Daily WTF</a></li>

	</ul>
</li>

	<li id="meta">
		<h2>Meta</h2>
		<ul>
				<li><a href="../../wp-login.html">Log in</a></li>
		<li><a href="../../feed/index.html" title="Syndicate this site using RSS">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
		<li><a href="../../comments/feed/index.html" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
		<li><a href="http://wordpress.org/" title="Powered by Wordpress, state-of-the-art semantic personal publishing platform.">Wordpress</a></li>
				</ul>
	</li>
	
</ul>
</div>

<div id="footer">

<!--<p>


Design by <a href="http://ravenkeller.com">Raven Keller</a> and <a href="http://weblogs.us" title="Theme sponsored by Weblogs.us">Weblogs.us</a>
&#183;
<a href="http://validator.w3.org/check/referer" title="This page validates as XHTML 1.0 Transitional"><abbr title="eXtensible HyperText Markup Language">XHTML</abbr></a>
&#183;
<a href="http://jigsaw.w3.org/css-validator/check/referer" title="This page validates as CSS"><abbr title="Cascading Style Sheets">CSS</abbr></a>
<img src='http://counter.dreamhost.com/cgi-bin/Count.cgi?df=danvk-maincounter.dat&pad=F&ft=0&dd=copper&istrip=T' align=right />
</p>-->


</div>

<script type='text/javascript' src='../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore677a.js?ver=3.0.9'></script>
<script type='text/javascript' src='../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp677a.js?ver=3.0.9'></script>
<script type='text/javascript' src='../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby677a.js?ver=3.0.9'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore677a.css?ver=3.0.9";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "../../wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault677a.css?ver=3.0.9";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>

<!-- Google Analytics -->
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-769809-1";
urchinTracker();
</script>

</body>

<!-- Mirrored from www.danvk.org/wp/page/35/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 15 Oct 2014 03:37:22 GMT -->
</html>	



<!--<footer class="container"></footer>-->
